function [data_V, data_JD] = loadData()
%LOADDATA 选择文件并读取电流数据
%   [V, JD] = LOADDATA() 弹出对话框让用户选择包含电流密度的文件，
%   然后询问需要读取的单元格范围(如 A1:A81)。电压向量固定为
%   -0.5V 至 0.3V，步长 0.01V。如果文件选择被取消或读取失败，
%   将返回内置示例数据。

       [file, path] = uigetfile({'*.xlsx;*.xls;*.csv', 'Data files (*.xlsx, *.xls, *.csv)'}, ...
                             '选择包含IV数据的文件');
    if ~isequal(file, 0)
        filename = fullfile(path, file);
        range_str = input('请输入电流数据的单元格范围(如A1:A81，留空取消): ', 's');
        if ~isempty(range_str)
            try
                raw = readmatrix(filename, 'Range', range_str);
                data_JD = raw(:);
                data_V = (-0.5:0.01:0.3)';
                if numel(data_JD) ~= numel(data_V)
                    guiLog(sprintf('读取的数据长度(%d)与电压向量长度(%d)不符。', ...
                            numel(data_JD), numel(data_V)));
                end
                return;
            catch ME
                guiLog(sprintf('读取 %s 失败: %s。使用内置示例数据。', filename, ME.message));
            end
        else
            guiLog('未输入范围，使用内置示例数据。');
        end
        else
            guiLog('未选择文件，使用内置示例数据。');
    end

    % 内置示例数据
    data_V = (-0.5:0.01:0.3)';

    data_JD = [-1.02668E-06	-0.000001002	-9.77662E-07	-9.59384E-07	-9.39687E-07	-9.19418E-07	-9.01413E-07	-8.85211E-07	-8.68227E-07	-8.52249E-07	-8.38309E-07	-8.23029E-07	-8.12773E-07	-7.99682E-07	-7.88076E-07	-7.76367E-07	-7.64989E-07	-7.53338E-07	-7.43293E-07	-7.32069E-07	-7.21591E-07	-7.11411E-07	-7.01644E-07	-6.91809E-07	-6.8268E-07	-6.7454E-07	-6.65024E-07	-6.56382E-07	-6.47722E-07	-6.39402E-07	-6.30373E-07	-6.20793E-07	-6.11484E-07	-6.01767E-07	-5.91587E-07	-5.80644E-07	-5.68733E-07	-5.566E-07	-5.43247E-07	-5.28669E-07	-5.11867E-07	-4.93098E-07	-4.7134E-07	-4.46167E-07	-4.16091E-07	-3.79502E-07	-3.34924E-07	-2.78633E-07	-2.07727E-07	-1.1686E-07	8.23879E-12	1.51867E-07	3.50671E-07	6.06502E-07	9.41893E-07	1.374E-06	1.93146E-06	2.6422E-06	3.54044E-06	4.66098E-06	6.0432E-06	7.72478E-06	9.74298E-06	1.21402E-05	1.49319E-05	1.81548E-05	2.18166E-05	2.59228E-05	3.04786E-05	3.5463E-05	4.08568E-05	4.66619E-05	5.28162E-05	5.93017E-05	6.61148E-05	7.32137E-05	8.05935E-05	8.82146E-05	9.61195E-05	0.000104259	0.000112696
]';
end
