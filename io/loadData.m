function [data_V, data_JD] = loadData()
%LOADDATA 从 CSV/XLSX 读取测量数据
%   [V, JD] = LOADDATA(FILENAME) 从指定文件加载电压和电流密度。如果
%   未提供 FILENAME，则弹出文件选择对话框。文件应至少包含两列，
%   第一列为电压，第二列为电流密度。若文件缺失或读取失败，则返
%   回内置示例数据

    if nargin < 1 || isempty(filename)
        [file, path] = uigetfile({'*.xlsx;*.xls;*.csv', 'Data files (*.xlsx, *.xls, *.csv)'}, ...
                                 '选择包含IV数据的文件');
        if isequal(file, 0)
            filename = 'example_data.csv';
        else
            filename = fullfile(path, file);
        end
    end
    
    if exist(filename, 'file')
        try
                if endsWith(lower(filename), {'.xls', '.xlsx'})
                range_str = input('请输入读取的单元格范围(留空表示自动): ', 's');
                if isempty(range_str)
                    raw = readmatrix(filename);
                else
                    raw = readmatrix(filename, 'Range', range_str);
                end
            else
                raw = readmatrix(filename);
            end
            data_V = raw(:, 1);
            data_JD = raw(:, 2);
            return;
        catch ME
            warning('读取 %s 失败: %s。使用内置示例数据。', filename, ME.message);
        end
    end

    % 内置示例数据
    data_V = [-0.5 -0.49 -0.48 -0.47 -0.46 -0.45 -0.44 -0.43 -0.42 -0.41 -0.4 ...
        -0.39 -0.38 -0.37 -0.36 -0.35 -0.34 -0.33 -0.32 -0.31 -0.3 -0.29 -0.28 ...
        -0.27 -0.26 -0.25 -0.24 -0.23 -0.22 -0.21 -0.2 -0.19 -0.18 -0.17 -0.16 ...
        -0.15 -0.14 -0.13 -0.12 -0.11 -0.1 -0.09 -0.08 -0.07 -0.06 -0.05 -0.04 ...
        -0.03 -0.02 -0.01 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 ...
        0.11 0.12 0.13 0.14 0.15 0.16 0.17 0.18 0.19 0.2 0.21 0.22 0.23 0.24 ...
        0.25 0.26 0.27 0.28 0.29 0.3];

    data_JD = [-5.06347E-07 -4.96793E-07 -4.89109E-07 -4.78536E-07 -4.73764E-07 ...
        -4.6228E-07 -4.55469E-07 -4.4706E-07 -4.40489E-07 -4.33549E-07 -4.29236E-07 ...
        -4.21522E-07 -4.16476E-07 -4.10267E-07 -4.0406E-07 -3.99367E-07 -3.93516E-07 ...
        -3.89736E-07 -3.83602E-07 -3.79571E-07 -3.75811E-07 -3.71384E-07 -3.67033E-07 ...
        -3.62871E-07 -3.57607E-07 -3.53544E-07 -3.49533E-07 -3.44536E-07 -3.41213E-07 ...
        -3.35242E-07 -3.33027E-07 -3.27004E-07 -3.23309E-07 -3.16664E-07 -3.13738E-07 ...
        -3.05982E-07 -3.02764E-07 -2.94927E-07 -2.89824E-07 -2.80531E-07 -2.72376E-07 ...
        -2.62591E-07 -2.53602E-07 -2.39578E-07 -2.2656E-07 -2.05831E-07 -1.83184E-07 ...
        -1.5346E-07 -1.1666E-07 -6.61556E-08 4.54599E-12 9.03511E-08 2.11476E-07 ...
        3.75042E-07 5.98227E-07 8.97813E-07 1.30495E-06 1.8512E-06 2.58555E-06 ...
