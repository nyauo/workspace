>> main
是否使用历史参数文件作为初始参数? (y/n): n
使用Lambert W函数估计初始参数...

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.
Lambert W估计的参数:
J01 = 7.793222e-08 A
Rs = 4.679676e+02 Ohm
Rsh = 1.765055e+06 Ohm
J02 = 1.000000e-08 A

初始参数（使用Lambert W函数估计）：
J01 = 7.793222e-08 A
Rs  = 4.679676e+02 Ohm
Rsh = 1.765055e+06 Ohm
k   = 5.000000e-07
J02 = 1.000000e-08 A

开始使用levenberg-marquardt算法进行拟合...
错误使用 performFitting (第 88 行)
拟合过程出错: 未定义与 'optim.options.Lsqnonlin' 类型的输入参数相对应的函数 'fit_negative_region'。

出错 main (第 85 行)
    [optimized_params, fit_results] = performFitting(data_V, data_JD, params, config);
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 
>> main
是否使用历史参数文件作为初始参数? (y/n): n
使用Lambert W函数估计初始参数...

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.

MultiStart completed the runs from all start points. 

All 3 local solver runs converged with a positive local solver exitflag.
Lambert W估计的参数:
J01 = 8.832628e-08 A
Rs = 4.679676e+02 Ohm
Rsh = 1.765055e+06 Ohm
J02 = 1.000000e-08 A

初始参数（使用Lambert W函数估计）：
J01 = 8.832628e-08 A
Rs  = 4.679676e+02 Ohm
Rsh = 1.765055e+06 Ohm
k   = 5.000000e-07
J02 = 1.000000e-08 A

开始使用levenberg-marquardt算法进行拟合...

第一阶段：优化Rsh和非欧姆系数k...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5         0.975092           0.851         0.01
     1          11         0.803105            2.79          0.1        1.11963
     2          16         0.213937           0.298         0.01       0.459385
     3          21         0.198383        0.000484        0.001       0.160497
     4          26         0.198374         2.3e-06       0.0001      0.0906978
     5          31         0.198374        8.22e-09        1e-05      0.0923807
     6          36         0.198374        4.59e-10        1e-06      0.0922197

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          29.5854            1.44         0.01
     1          10           10.541            4.44        0.001        16.5459
     2          15          4.23864            0.96       0.0001        1.45183
     3          20          2.84151          0.0819        1e-05        1.55733
     4          25          2.82374         0.00594        1e-06        2.87177
     5          30          2.82191        0.000355        1e-07        26.7077
     6          36          2.81902        0.000603        1e-06        36.1654
     7          41          2.81361         0.00039        1e-07        48.1773
     8          47          2.79863         0.00275        1e-06        71.4624
     9          53          2.79266        0.000237        1e-05        16.4209
    10          58          2.78226         0.00122        1e-06        20.9258
    11          64          2.75687         0.00322        1e-05        29.7485
    12          69          2.34571           0.143        1e-06        59.7615
    13          78          2.12395          0.0413         0.01        2.44653
    14          83          1.58234           0.141        0.001        3.90174
    15          90           1.2012            0.14          0.1        1.18584
    16          95         0.722604            0.26         0.01         1.4203
    17         101          0.33434           0.216          0.1        1.21435
    18         106         0.219066           0.347         0.01       0.791939
    19         111         0.198381        0.000332        0.001       0.171679
    20         116         0.198374        1.35e-06       0.0001      0.0909046
    21         121         0.198374        1.11e-09        1e-05      0.0922683
    22         132         0.198374        2.06e-09           10     0.00838352

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          202.835            1.54         0.01
     1          10          4.05647           0.868        0.001         69.562
     2          15          2.84487          0.0612       0.0001        1.46655
     3          20          2.83487         0.00502        1e-05       0.191055
     4          25           2.8348        0.000497        1e-06       0.433894
     5          30          2.83475        0.000143        1e-07        5.21621
     6          35          2.83406        0.000247        1e-08        63.8486
     7          40          2.81356         0.00515        1e-09         507.93
     8          48          2.80052         0.00154        1e-06         64.273
     9          54          2.79574         0.00018        1e-05        14.6739
    10          59          2.78818        0.000589        1e-06        17.9878
    11          65          2.77282         0.00183        1e-05         24.517
    12          70          2.71573          0.0109        1e-06        39.1447
    13          77          2.66806         0.00539       0.0001        12.9098
    14          82          2.28073           0.116        1e-05        24.6059
    15          90          2.01633          0.0523         0.01         2.7994
    16          95          1.41669            0.45        0.001        4.80598
    17         102         0.533116           0.177          0.1        1.57812
    18         107         0.273901           0.328         0.01         1.0636
    19         112         0.223131            0.18        0.001       0.191798
    20         117         0.205077          0.0138       0.0001      0.0719331
    21         122         0.198616          0.0135        1e-05      0.0869092
    22         127         0.198376        7.77e-05        1e-06      0.0850113
    23         132         0.198374        3.97e-07        1e-07      0.0928225
    24         137         0.198374        3.61e-09        1e-08       0.092251
    25         142         0.198374        2.02e-09        1e-09       0.092306

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          124.427            1.62         0.01
     1          10          34.8754              29        0.001        50.6711
     2          15            12.03            5.43       0.0001       0.896998
     3          20          4.66036            1.15        1e-05        1.44367
     4          25          2.87559           0.134        1e-06        2.33586
     5          30          2.82946         0.00873        1e-07        14.4938
     6          35          2.82284        0.000184        1e-08        148.356
     7          42          2.82046        0.000312        1e-06        33.2042
     8          47          2.81655        5.42e-05        1e-07         41.335
     9          53          2.80869         0.00146        1e-06        54.1134
    10          58          2.76512         0.00986        1e-07        100.845
    11          65          2.62578          0.0346        1e-05        50.3646
    12          72          2.58524          0.0055        0.001        3.95979
    13          77          2.50791          0.0101       0.0001        5.44576
    14          83          2.19707          0.0696        0.001        8.90214
    15          89          1.83194          0.0713         0.01        3.31282
    16          95           1.6751          0.0998          0.1       0.804244
    17         100          1.42288           0.134         0.01        1.00006
    18         106         0.978018           0.154          0.1        1.28449
    19         111         0.604862           0.532         0.01        1.40455
    20         117         0.236748           0.106          0.1        1.00596
    21         123         0.217604          0.0955            1       0.096139
    22         128         0.200608         0.00216          0.1      0.0910874
    23         133         0.198404         0.00158         0.01      0.0817202
    24         138         0.198374        8.31e-06        0.001      0.0887231
    25         143         0.198374        8.47e-08       0.0001      0.0923521
    26         148         0.198374        7.53e-09        1e-05      0.0922224

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          23.3227            1.37         0.01
     1          10          6.35852             2.1        0.001          13.71
     2          15          3.05396           0.432       0.0001        3.99551
     3          20          2.16749           0.538        1e-05        29.9397
     4          29         0.854149           0.207          0.1        1.89647
     5          34         0.476126           0.468         0.01        1.34099
     6          40         0.198515         0.00707          0.1        0.89953
     7          45         0.198374        1.52e-05         0.01      0.0892565
     8          50         0.198374        4.27e-08        0.001      0.0910533
     9          55         0.198374        1.25e-08       0.0001      0.0921155

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.
负电压区域拟合：平均相对误差 = 12.24%, 最大相对误差 = 28.12%
优化后的Rsh = 1.039471e+06 Ohm
优化后的k = 1.000000e-08

第二阶段：细分正电压区域优化...
优化低正电压区域 (0 - 0.15V)...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3         0.377762           0.901         0.01
     1           6          0.11981          0.0519        0.001       0.278714
     2           9          0.11531         0.00452       0.0001      0.0283388
     3          12         0.115048          0.0502        1e-05     0.00258521
     4          15         0.113749         0.00148        1e-06      0.0274544
     5          25         0.113748         0.00012           10    0.000126135
     6          29                                                 1.19537e-08

优化已停止，因为当前步长的相对范数 9.796278e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3          30.7328          0.0743         0.01
     1           6           29.589           0.083        0.001        7.28876
     2          10          28.1496          0.0952         0.01        8.10281
     3          13           26.235           0.114        0.001        9.20985
     4          17          23.4496           0.146         0.01         10.821
     5          20          18.6762           0.221        0.001         13.348
     6          24          6.53219           0.584         0.01        17.3799
     7          28          1.43466            0.71          0.1        3.78068
     8          31         0.154477           0.311         0.01        1.45012
     9          34         0.113957          0.0247        0.001       0.134307
    10          37         0.113761         0.00642       0.0001      0.0136849
    11          40          0.11375         0.00235        1e-05     0.00373492
    12          43         0.113749         0.00368        1e-06     0.00134717
    13          55         0.113749         0.00269         1000    3.66944e-06
    14          60         0.113749        5.61e-06       100000    2.68609e-08
    15          63         0.113749         0.00119        10000    5.60862e-11

优化已停止，因为当前步长的相对范数 4.595311e-11 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3          3.41725           0.708         0.01
     1           7         0.131562           0.186          0.1        2.77451
     2          10         0.113979          0.0197         0.01      0.0865604
     3          13         0.113749          0.0025        0.001      0.0110494
     4          22         0.113749          0.0041         1000    2.49256e-06
     5          26         0.113749        0.000448        10000    4.10384e-07
     6          28                                                 4.48012e-09

优化已停止，因为当前步长的相对范数 3.673179e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3          29.1966          0.0861         0.01
     1           6          27.6414          0.0999        0.001        8.38921
     2          10          25.5248           0.121         0.01        9.62579
     3          13          22.3296           0.161        0.001        11.4446
     4          17          16.3998           0.268         0.01        14.3866
     5          20          1.38296            2.94        0.001         18.402
     6          23         0.195081           0.463       0.0001       0.421349
     7          26         0.114482          0.0304        1e-05       0.179643
     8          29         0.113768         0.00256        1e-06      0.0171751
     9          32         0.113755         0.00467        1e-07     0.00147997
    10          35         0.113749         0.00367        1e-08     0.00266922
    11          46         0.113749         0.00393            1     0.00134775
    12          50         0.113749         0.00359           10    0.000334357
    13          55         0.113749          0.0017         1000    3.57887e-06
    14          59                                                 1.70092e-09

优化已停止，因为当前步长的相对范数 1.394248e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3          31.6436          0.0679         0.01
     1           6          30.6926          0.0745        0.001        6.68806
     2           9          9.81719           0.456       0.0001        62.6947
     3          15           5.8735           0.612          0.1        3.73594
     4          18         0.831309           0.641         0.01        3.67276
     5          21          0.21128           0.495        0.001        1.07942
     6          24         0.114849          0.0467       0.0001       0.192301
     7          27         0.113749         0.00198        1e-05      0.0255794
     8          38         0.113749        6.05e-05         1000    1.98116e-06
     9          42         0.113749        0.000441        10000    6.04787e-09

优化已停止，因为当前步长的相对范数 4.954657e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.
低正电压区域拟合：平均相对误差 = 17.37%, 最大相对误差 = 35.48%
优化后的J0 = 1.220229e-07 A
优化高正电压区域 (>0.15V)...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3         0.282729           0.128         0.01
     1           6        0.0870256          0.0226        0.001        1.40454
     2           9        0.0769188         0.00135       0.0001       0.433445
     3          12         0.076878        3.58e-06        1e-05      0.0297414
     4          15         0.076878        1.94e-05        1e-06      7.979e-05
     5          18         0.076878         6.5e-06        1e-07    0.000433143
     6          29         0.076878        1.43e-05           10    6.46962e-07

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3        0.0780143         0.00694         0.01
     1           6        0.0769202         0.00135        0.001       0.131084
     2           9        0.0768781        5.99e-05       0.0001      0.0295721
     3          12         0.076878        2.15e-05        1e-05     0.00133132
     4          20         0.076878        3.12e-06            1    2.05359e-05

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3          3.83695            1.55         0.01
     1           6         0.657288           0.265        0.001        2.31787
     2           9         0.102191          0.0371       0.0001        2.13451
     3          12        0.0769815         0.00216        1e-05       0.670688
     4          15         0.076878        3.82e-05        1e-06      0.0475513
     5          18         0.076878        2.65e-06        1e-07    0.000850654
     6          28         0.076878        1.13e-05            1    2.53711e-06

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3         0.477989           0.202         0.01
     1           6         0.099921          0.0352        0.001        1.77952
     2           9        0.0770125         0.00248       0.0001       0.632566
     3          12         0.076878        2.73e-05        1e-05      0.0541934
     4          15         0.076878        1.89e-06        1e-06    0.000608789
     5          18         0.076878        2.62e-05        1e-07    4.20376e-05

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           3        0.0805844          0.0123         0.01
     1           6        0.0770159         0.00246        0.001       0.239187
     2           9        0.0768781        7.83e-05       0.0001      0.0543609
     3          12         0.076878        4.05e-06        1e-05      0.0017412
     4          16         0.076878        1.43e-05       0.0001    9.01175e-05

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.
高正电压区域拟合：平均相对误差 = 11.77%, 最大相对误差 = 20.47%
优化后的Rs = 6.548000e+02 Ohm

综合优化正电压区域...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5         0.153376         0.00462         0.01
     1          16         0.153376         0.00722        10000    4.64119e-07
     2          21         0.153376         0.00246         1000    7.21845e-07
     3          24                                                 2.58132e-08

优化已停止，因为当前步长的相对范数 3.875433e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          38.7811            2.19         0.01
     1          10          24.3925         0.00263        0.001        10.5424
     2          15          19.9695          0.0112       0.0001        38.9796
     3          22          18.6875          0.0166         0.01        7.57924
     4          27          16.8714          0.0291        0.001        8.81466
     5          33          13.9277            0.07         0.01        10.7044
     6          38          7.62805           0.338        0.001        13.6684
     7          45           5.4779           0.412          0.1        2.91276
     8          50          2.60789           0.515         0.01        3.08014
     9          56         0.440445           0.199          0.1        2.33298
    10          61         0.338917          0.0521         0.01       0.540123
    11          66         0.178416          0.0231        0.001        2.02362
    12          71         0.153432         0.00235       0.0001       0.952158
    13          76          0.15336        0.000509        1e-05      0.0383454
    14          86         0.153359         0.00666            1    0.000487918
    15          91         0.153338          0.0136          0.1     0.00242471
    16          98         0.153335         0.00557           10     0.00116816
    17         105         0.153335         0.00193         1000    5.61691e-06
    18         108                                                 1.94161e-08

优化已停止，因为当前步长的相对范数 2.927998e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          24.2974           0.786         0.01
     1          10          21.4543           0.007        0.001        12.8151
     2          15          6.08552           0.389       0.0001        53.3833
     3          23          3.39201            0.49          0.1        3.06563
     4          28         0.682736           0.387         0.01        2.71028
     5          33         0.248538           0.301        0.001        2.29269
     6          38         0.153694          0.0113       0.0001        1.50532
     7          43         0.153391         0.00864        1e-05       0.145993
     8          48         0.153347         0.00298        1e-06      0.0479187
     9          53         0.153336          0.0121        1e-07      0.0122405
    10          66         0.153334         0.00202           10     0.00103323
    11          71         0.153334         0.00221            1    0.000201556
    12          78         0.153334         0.00209          100    2.65364e-05
    13          82                                                 2.13557e-08

优化已停止，因为当前步长的相对范数 3.221777e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          44.3453            3.23         0.01
     1          10          24.0013         0.00304        0.001        9.09913
     2          15          18.8479          0.0159       0.0001        41.1366
     3          22          17.1072           0.027         0.01        8.66095
     4          27          14.3507           0.062        0.001         10.422
     5          33          8.69233           0.297         0.01        13.2881
     6          39          6.95349           0.357          0.1         2.6872
     7          44          4.57049           0.449         0.01        2.98409
     8          50          1.57288           0.515          0.1        3.01716
     9          55         0.391299          0.0582         0.01        1.57824
    10          60         0.185571          0.0261        0.001        2.35619
    11          65         0.153494         0.00752       0.0001        1.08092
    12          70         0.153457         0.00767        1e-05     0.00615639
    13          75         0.153347         0.00145        1e-06      0.0564784
    14          85         0.153344         0.00902          0.1     0.00341669
    15          91          0.15334         0.00658            1     0.00356577
    16          97                                                 6.60463e-08

优化已停止，因为当前步长的相对范数 9.955712e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0           5          46.1448            5.11         0.01
     1          10          22.5393           0.825        0.001        9.69259
     2          16          17.7471          0.0224         0.01        12.3724
     3          21          15.4059          0.0452        0.001        9.79998
     4          27          11.0948           0.165         0.01        12.2418
     5          32         0.580204           0.613        0.001        15.2326
     6          37         0.161029           0.079       0.0001        3.87121
     7          42         0.153432         0.00286        1e-05       0.323314
     8          47         0.153371         0.00268        1e-06      0.0859264
     9          57         0.153344         0.00258          0.1      0.0199369
    10          62         0.153337        0.000611         0.01     0.00139445
    11          69         0.153337         0.00719            1    0.000565973
    12          78         0.153337         0.00725        10000    7.20486e-07
    13          83         0.153337         0.00573         1000    7.45207e-07
    14          86                                                 5.97872e-08

优化已停止，因为当前步长的相对范数 9.014253e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.
正电压区域综合拟合：平均相对误差 = 12.91%, 最大相对误差 = 23.78%
优化后的J0 = 1.216358e-07 A
优化后的Rs = 6.515989e+02 Ohm

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11         0.449121           0.399         0.01
     1          22         0.307242          0.0609        0.001        1.00439
     2          33         0.279296         0.00366       0.0001       0.737807
     3          44         0.197681         0.00343        1e-05        3.23636
     4          55        0.0832248           0.116        1e-06        10.2695
     5          66        0.0561446          0.0667        1e-07        1.30523
     6          77        0.0502015           0.016        1e-08        1.11091
     7          88        0.0441968          0.0234        1e-09        1.37253
     8         105        0.0407402          0.0435        0.001        1.35292
     9         116        0.0369508         0.00264       0.0001        0.50344
    10         128        0.0354122          0.0114        0.001        0.96251
    11         139        0.0347896        0.000937       0.0001       0.398247
    12         150        0.0336732         0.00623        1e-05        1.36553
    13         161        0.0334378         0.00234        1e-06      0.0820664
    14         172        0.0333626         0.00349        1e-07        0.20752
    15         186        0.0326798          0.0222       0.0001        2.29202
    16         197        0.0320531         0.00117        1e-05       0.294077
    17         208        0.0315281         0.00937        1e-06        3.19434
    18         219        0.0311609         0.00371        1e-07       0.918165
    19         234        0.0311489         0.00167        0.001      0.0359508
    20         245        0.0311216         0.00219       0.0001       0.168018
    21         256         0.031024         0.00387        1e-05        0.84045
    22         267         0.030708         0.00454        1e-06        5.06425
    23         278        0.0306088         0.00245        1e-07       0.172751
    24         289        0.0305505         0.00504        1e-08       0.919253
    25         307        0.0305472         0.00271          0.1     0.00497058
    26         318        0.0305392        0.000864         0.01     0.00726913
    27         329        0.0305356         0.00132        0.001      0.0186122
    28         340        0.0305265         0.00273       0.0001       0.121204
    29         356        0.0305262          0.0025           10    0.000287115
    30         367        0.0305259         0.00128            1     0.00025689
    31         378        0.0305259         0.00129          0.1    0.000304499
    32         390        0.0305257         0.00233            1     0.00112797
    33         401        0.0305254          0.0019          0.1    0.000992492
    34         407                                                 2.56759e-07

优化已停止，因为当前步长的相对范数 8.122038e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          3067.72           0.189         0.01
     1          22          2962.57         0.00404        0.001        94.8757
     2          33          2915.26        0.000425       0.0001        262.292
     3          44          2781.05        0.000547        1e-05        796.073
     4          55           1011.1          0.0173        1e-06        6789.88
     5          68            258.2          0.0269       0.0001        1456.86
     6          80          106.035          0.0355        0.001        229.295
     7          91          10.7424            9.05       0.0001        161.999
     8         102          1.87956            9.21        1e-05        44.2456
     9         113         0.809221            1.41        1e-06       0.992499
    10         124         0.253888           0.608        1e-07        39.3332
    11         135        0.0444995           0.166        1e-08        16.8265
    12         146        0.0297619          0.0139        1e-09        6.29063
    13         157        0.0296337         0.00241        1e-10        122.039
    14         180        0.0296337         0.00175          100    2.82176e-05
    15         192        0.0296337        0.000783         1000    1.87356e-06

优化已停止，因为当前步长的相对范数 2.910151e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          7550.36           0.179         0.01
     1          22           5217.2        1.37e-05        0.001        22.1982
     2          33          5213.73        1.42e-05       0.0001        131.829
     3          44          5210.96        5.15e-07        1e-05        438.795
     4          55          5209.48        6.22e-08        1e-06        804.171
     5          66          5193.12        7.87e-08        1e-07        2781.96
     6          77          4710.95        4.36e-06        1e-08        30550.5
     7          88          3158.11             364        1e-09         188258
     8          99          1120.22            40.2        1e-10        12.8655
     9         110          337.353            10.3        1e-11        568.788
    10         121          82.0986            78.1        1e-12         217.91
    11         132          15.0111            18.4        1e-13        59.6867
    12         143           1.6956            2.77        1e-14         41.201
    13         154        0.0983758             0.3        1e-15        19.0056
    14         165        0.0299282         0.00365        1e-16        231.664
    15         176        0.0297847          0.0038        1e-17        5.61626
    16         199        0.0297781          0.0023        1e-05        1.25095
    17         215        0.0297777        0.000356            1     0.00163032
    18         226        0.0297774        0.000428          0.1    0.000398297
    19         237        0.0297769         0.00143         0.01     0.00225355
    20         250        0.0297763        0.000667            1     0.00104082
    21         261        0.0297761         0.00233          0.1    0.000638356
    22         274         0.029776        0.000839           10    0.000178627
    23         286         0.029776         0.00199          100    8.85859e-06
    24         297         0.029776        0.000638           10    2.13691e-05
    25         308         0.029776          0.0014            1    7.20414e-05
    26         313                                                 1.92977e-07

优化已停止，因为当前步长的相对范数 2.039194e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          8005.12           0.225         0.01
     1          22          5212.31        5.96e-08        0.001        21.3516
     2          33           5212.3        5.97e-08       0.0001        124.739
     3          44          5212.15        5.98e-08        1e-05        127.777
     4          55          5210.64        6.12e-08        1e-06        300.989
     5          66          5194.53        7.72e-08        1e-07        2765.93
     6          77           4728.7        3.99e-06        1e-08        30246.2
     7          88          3158.11             361        1e-09         193953
     8          99          1118.65            40.3        1e-10         55.476
     9         110          340.492            10.2        1e-11         100.51
    10         121          82.9587            75.2        1e-12        256.501
    11         132          15.4358            18.4        1e-13        3.51276
    12         143          1.85286            2.73        1e-14        193.654
    13         159        0.0950689           0.325        1e-09        745.164
    14         170        0.0301776          0.0202        1e-10        4.83334
    15         181        0.0298043         0.00515        1e-11        22.4633
    16         192        0.0297959         0.00108        1e-12        2.94108
    17         218        0.0297959         0.00138         1000    1.33309e-06
    18         229        0.0297958         0.00271          100    1.83851e-06
    19         240        0.0297958         0.00136           10    3.21948e-05
    20         253        0.0297958          0.0018         1000    1.77913e-06
    21         265        0.0297958         0.00116        10000     1.8346e-07

优化已停止，因为当前步长的相对范数 2.082120e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5717.21           0.228         0.01
     1          22          4824.73        2.35e-06        0.001        103.773
     2          33          4824.23        2.36e-06       0.0001        86.8065
     3          44          4819.62        5.52e-05        1e-05        178.742
     4          55          4778.54        3.03e-06        1e-06        2205.84
     5          66          4013.79            72.2        1e-07        16439.2
     6          77           769.98            3.36        1e-08        54433.2
     7          88          155.498             691        1e-09        17.0558
     8          99          43.6503             129        1e-10        18.1554
     9         110          14.2766            20.7        1e-11        24.0981
    10         121           2.3002            2.38        1e-12         11.946
    11         144          1.29011             2.5            1       0.738203
    12         155         0.533888           0.257          0.1       0.437894
    13         166         0.216798          0.0825         0.01       0.963993
    14         177        0.0827437          0.0211        0.001        1.42889
    15         188        0.0551372           0.025       0.0001        2.47254
    16         199        0.0489096          0.0916        1e-05        1.81927
    17         210        0.0385919          0.0493        1e-06        2.66293
    18         221        0.0328047          0.0273        1e-07        3.06731
    19         232        0.0313826         0.00298        1e-08        2.06592
    20         243        0.0313498        0.000561        1e-09       0.131286
    21         254        0.0312401         0.00117        1e-10       0.663167
    22         265        0.0312199         0.00145        1e-11      0.0847452
    23         286        0.0312198         0.00213          0.1     0.00363225
    24         298        0.0312189        0.000703            1    0.000929849
    25         313        0.0312189         0.00089        10000    9.84351e-08

优化已停止，因为当前步长的相对范数 3.653254e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11         0.0296337                            0.107
     1         22         0.0296327         1.46277          0.00122      
     2         33         0.0296327        0.365693          0.00122      
     3         44         0.0296317       0.0914232           0.0273      
     4         55         0.0296317       0.0228558           0.0273      
     5         66         0.0296317      0.00571395           0.0273      
     6         77         0.0296317      0.00142849           0.0273      
     7         88         0.0296317     0.000357122           0.0273      
     8         99         0.0296317     8.92804e-05           0.0273      
     9        110         0.0296317     2.23201e-05           0.0273      
    10        121         0.0296317     5.58003e-06           0.0273      
    11        132         0.0296317     1.39501e-06           0.0273      
    12        143         0.0296317     3.48752e-07           0.0273      
    13        154         0.0296317     8.71879e-08           0.0273      
    14        165         0.0296317      2.1797e-08             1.91      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6624.26                              952
     1         22           5308.47              10              343      
     2         33           5038.47         19.5699              328      
     3         44           4869.18         38.4729              455      
     4         55           4242.31         76.0046              728      
     5         66           1648.69         123.582              549      
     6         77           551.318          51.059              256      
     7         88           153.307         28.1315              102      
     8         99           35.0742           13.65             34.7      
     9        110           5.93736         18.5769              104      
    10        121          0.901622         2.90349             36.4      
    11        132          0.220764         11.9336             13.8      
    12        143         0.0395691         6.37089             5.48      
    13        154         0.0297959         1.38906            0.848      
    14        165          0.029661         2.79936             19.2      
    15        176         0.0296497         0.69984            0.209      
    16        187         0.0296464         0.17496           0.0448      
    17        198         0.0296464         0.17496           0.0448      
    18        209         0.0296464         0.04374           0.0448      
    19        220         0.0296464        0.010935           0.0448      
    20        231         0.0296464      0.00273375           0.0448      
    21        242         0.0296464     0.000683438           0.0448      
    22        253         0.0296464     0.000170859           0.0448      
    23        264         0.0296464     4.27148e-05           0.0448      
    24        275         0.0296464     1.06787e-05           0.0448      
    25        286         0.0296464     2.66968e-06           0.0448      
    26        297         0.0296464      6.6742e-07           0.0448      
    27        308         0.0296464     1.66855e-07          0.00397      
    28        319         0.0296464     1.66855e-07          0.00397      
    29        330         0.0296464     4.17137e-08          0.00397      
    30        341         0.0296464     1.04284e-08           0.0563      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           906.737                              186
     1         22           661.078              10              153      
     2         33           256.839              20             86.6      
     3         44           61.7468          15.693             31.5      
     4         55           11.1045         7.86829             9.57      
     5         66            1.2128         10.6488             2.21      
     6         77          0.138633          7.5042            0.304      
     7         88         0.0388377         10.2235             1.37      
     8         99         0.0300894         4.66148          0.00748      
     9        110         0.0296346         4.72469          0.00519      
    10        121          0.029628         1.32274             22.8      
    11        132         0.0296239        0.330685          0.00239      
    12        143         0.0296239       0.0826712          0.00239      
    13        154         0.0296239       0.0206678          0.00239      
    14        165         0.0296239      0.00516695          0.00239      
    15        176         0.0296239      0.00129174             3.69      
    16        187         0.0296238     0.000322934            0.015      
    17        198         0.0296237     8.07336e-05          0.00278      
    18        209         0.0296235     8.07336e-05            0.198      
    19        220         0.0296235     8.07336e-05            0.198      
    20        231         0.0296235     2.01834e-05            0.198      
    21        242         0.0296235     5.04585e-06            0.198      
    22        253         0.0296235     1.26146e-06            0.198      
    23        264         0.0296235     3.15366e-07            0.198      
    24        275         0.0296235     7.88414e-08            0.198      
    25        286         0.0296235     1.97103e-08            0.198      
    26        297         0.0296235     4.92759e-09            0.198      

优化已停止，因为当前步长的范数 4.927587e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           3840.17                              846
     1         22           3514.61              10              742      
     2         33           3218.29         18.1126              723      
     3         44           2475.09              40              655      
     4         55           885.174         67.3789              333      
     5         66           267.354         34.2916              141      
     6         77           65.2182         20.5327             51.7      
     7         88           12.8252         15.0978               16      
     8         99           1.72174         7.32586             3.99      
     9        110           0.24282         4.39342            0.809      
    10        121         0.0507827         3.02972             4.33      
    11        132         0.0304111         6.12057             1.46      
    12        143         0.0296775         6.56363             22.2      
    13        154         0.0296334          3.0437             2.04      
    14        165         0.0296334         2.46573             2.04      
    15        176         0.0296334        0.616433             2.04      
    16        187         0.0296332        0.154108             9.47      
    17        198         0.0296329        0.038527            0.019      
    18        209         0.0296329      0.00963176            0.019      
    19        220         0.0296329      0.00240794            0.019      
    20        231         0.0296329     0.000601985            0.019      
    21        242         0.0296329     0.000150496            0.019      
    22        253         0.0296329     3.76241e-05            0.019      
    23        264         0.0296329     9.40602e-06            0.019      
    24        275         0.0296329      2.3515e-06            0.019      
    25        286         0.0296329     5.87876e-07            0.019      
    26        297         0.0296329     1.46969e-07          0.00258      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5885.25                              317
     1         22           5347.72              10              102      
     2         33           5309.07         19.0749              109      
     3         44           5275.12            38.1              130      
     4         55           5169.57         75.8604              209      
     5         66            4060.3             160              765      
     6         77           1573.82         114.759              538      
     7         88           522.271         43.4948              249      
     8         99           19.0745         26.8179              240      
     9        110           3.10095         12.1861             5.92      
    10        121           0.48859         6.37799             1.37      
    11        132           0.11654         5.93637             7.95      
    12        143         0.0327958         21.1963             1.49      
    13        154         0.0296418         1.04305            0.196      
    14        165         0.0296329        0.800152             12.8      
    15        176         0.0296329         2.16183             12.8      
    16        187         0.0296314        0.540457            0.108      
    17        198         0.0296314        0.135114            0.108      
    18        209         0.0296296       0.0337786           0.0859      
    19        220         0.0296296      0.00844464           0.0859      
    20        231         0.0296296      0.00211116           0.0859      
    21        242         0.0296296      0.00052779           0.0859      
    22        253         0.0296296     0.000131948           0.0859      
    23        264         0.0296296     3.29869e-05           0.0859      
    24        275         0.0296296     8.24672e-06           0.0859      
    25        286         0.0296296     2.06168e-06           0.0859      
    26        297         0.0296296      5.1542e-07           0.0859      
    27        308         0.0296296     1.28855e-07           0.0859      
    28        319         0.0296296     3.22138e-08           0.0859      
    29        330         0.0296296     8.05344e-09           0.0859      

优化已停止，因为当前步长的范数 8.053438e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.29%, 最大相对误差 = 103.30%
Trust-Region-Reflective: 平均相对误差 = 4.29%, 最大相对误差 = 103.02%

Levenberg-Marquardt: 负区域误差 = 1.31%, 正区域误差 = 5.96%
Trust-Region-Reflective: 负区域误差 = 1.31%, 正区域误差 = 5.97%
整体表现更好: Trust-Region-Reflective算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0296235        0.000623         0.01
     1          22        0.0296227         0.00249        0.001      0.0128603
     2          36        0.0296208        7.97e-05            1     0.00210538
     3          47        0.0296208        0.000993          0.1    5.30959e-05
     4          60        0.0296208         0.00191           10    0.000102183
     5          72        0.0296208         0.00101          100     1.9629e-05
     6          84        0.0296208         0.00246         1000    1.02117e-06

优化已停止，因为当前步长的相对范数 1.233683e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 103.20%
平均相对误差: 4.29%
平均误差 4.29% 低于阈值，结束优化。
未达到误差阈值，尝试在2.0到3.0范围内调整m...

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0940185           0.194         0.01
     1          22        0.0317489          0.0121        0.001       0.327569
     2          33         0.030811         0.00269       0.0001       0.421342
     3          44        0.0307296        0.000955        1e-05       0.124777
     4          55        0.0307036         0.00261        1e-06       0.198768
     5          71        0.0307028         0.00357          0.1     0.00426943
     6          83        0.0307023         0.00262            1     0.00210816
     7          95         0.030702         0.00297           10    0.000248291
     8         106        0.0307013         0.00149            1    0.000260012
     9         118        0.0307011        0.000574           10    0.000169578
    10         129         0.030701         0.00161            1    4.95946e-05
    11         133                                                 1.65218e-06

优化已停止，因为当前步长的相对范数 1.996496e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6855.44           0.229         0.01
     1          22          6103.58           0.511        0.001        59.9076
     2          33          4765.27        3.31e-06       0.0001        242.915
     3          44          4759.94         3.4e-06        1e-05        181.308
     4          55          4702.95        0.000101        1e-06        1636.55
     5          66          3656.01         0.00153        1e-07        16507.7
     6          77          479.222            8.44        1e-08        58203.7
     7          94          159.425            26.5         0.01        72.4457
     8         106          57.0485            61.2          0.1        13.6385
     9         117          11.7688            11.2         0.01        8.73773
    10         128           1.2864            2.07        0.001        7.74728
    11         139         0.125935           0.151       0.0001        7.44839
    12         150        0.0345633          0.0529        1e-05        5.76137
    13         161        0.0307682          0.0028        1e-06         1.3308
    14         172        0.0307395         0.00242        1e-07            2.2
    15         183        0.0307256         0.00153        1e-08        35.3004
    16         201        0.0307246        0.000894          0.1     0.00341538
    17         213        0.0307244        0.000824            1    0.000556008
    18         217                                                 1.16999e-06

优化已停止，因为当前步长的相对范数 2.361017e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6562.19           0.132         0.01
     1          22          5142.69        3.35e-05        0.001        173.123
     2          33          5138.75        1.59e-07       0.0001        133.552
     3          44          5138.33         1.6e-07        1e-05        126.273
     4          55          5134.34        1.13e-06        1e-06        491.926
     5          66          5090.74        2.75e-07        1e-07        4551.75
     6          77           197.46             145        1e-08        57403.6
     7          88          63.2695            94.2        1e-09        14.7858
     8          99          18.9852            23.1        1e-10        33.7623
     9         110          11.1364              15        1e-11        15.8574
    10         121          4.75313            1.87        1e-12        7.74033
    11         132          1.28619            3.63        1e-13        16.1594
    12         143         0.414028           0.884        1e-14        9.39068
    13         154         0.112009            0.12        1e-15        11.0057
    14         165        0.0360901          0.0386        1e-16        9.99302
    15         176        0.0319244         0.00694        1e-17        1.05621
    16         187        0.0318812         0.00313        1e-18       0.688748
    17         198         0.031619         0.00385        1e-19        8.51757
    18         209        0.0314154         0.00486        1e-20        7.82553
    19         220        0.0313686         0.00958        1e-21        4.60788
    20         231        0.0312876         0.00146        1e-22        2.48473
    21         260        0.0312864         0.00226       0.0001       0.131657
    22         271        0.0312855          0.0008        1e-05       0.271083
    23         281                                                 9.44114e-08

优化已停止，因为当前步长的相对范数 1.717624e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          3596.26          0.0428         0.01
     1          22          3432.83          0.0189        0.001        77.0444
     2          33          3364.38        0.000178       0.0001        635.447
     3          44             3282         0.00021        1e-05        630.639
     4          55          2275.86         0.00141        1e-06        5842.03
     5          68          2024.98         0.00228       0.0001        1057.84
     6          79          1707.99         0.00423        1e-05        1166.66
     7          91          1284.41          0.0103       0.0001        1301.35
     8         102          670.681           0.022        1e-05        1440.65
     9         115          548.263          0.0228        0.001        231.941
    10         126          410.848          0.0239       0.0001        240.692
    11         138          258.816          0.0266        0.001        244.435
    12         149          106.572          0.0336       0.0001        229.441
    13         161          10.9127            8.49        0.001        162.437
    14         172          1.66218            6.37       0.0001        37.1446
    15         183         0.821142            1.38        1e-05         5.6463
    16         194         0.168845           0.639        1e-06        9.05711
    17         205        0.0411118           0.156        1e-07        5.64041
    18         216        0.0308444         0.00872        1e-08         28.055
    19         227        0.0307853         0.00787        1e-09         24.345
    20         238        0.0307778         0.00323        1e-10        24.6989
    21         260        0.0307776         0.00135           10    0.000287404
    22         263                                                 1.70223e-06

优化已停止，因为当前步长的相对范数 6.424267e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          7226.45           0.365         0.01
     1          22          5777.14            0.12        0.001         46.312
     2          33          4956.07        9.57e-07       0.0001        262.051
     3          44          4954.18        0.000161        1e-05         138.03
     4          55          4936.71         1.1e-06        1e-06         1948.7
     5          66          4644.71        5.91e-06        1e-07        13326.3
     6          77          2941.39             288        1e-08          97083
     7          88          1031.43            33.1        1e-09        33.4328
     8          99          306.183            11.5        1e-10        863.994
     9         110          74.1001            84.5        1e-11        330.321
    10         121           13.343            17.3        1e-12        13.7981
    11         132          1.46281            2.59        1e-13        53.4546
    12         143        0.0833328           0.303        1e-14        223.832
    13         154        0.0310101          0.0157        1e-15        232.181
    14         165        0.0307541         0.00598        1e-16        38.8886
    15         176        0.0307501           0.004        1e-17        101.536
    16         187         0.030731         0.00499        1e-18        35.5887
    17         198        0.0307217         0.00301        1e-19        44.3883
    18         228         0.030719          0.0019            1     0.00175957
    19         239        0.0307183         0.00184          0.1    0.000554569
    20         253        0.0307183        0.000562          100    1.88453e-05
    21         265        0.0307183         0.00257         1000    6.41839e-07

优化已停止，因为当前步长的相对范数 1.176763e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11          0.030701                             3.21
     1         22          0.030701         2.00346             3.21      
     2         33          0.030701        0.500864             3.21      
     3         44          0.030701        0.125216             3.21      
     4         55          0.030701        0.031304             3.21      
     5         66          0.030701      0.00782601             3.21      
     6         77          0.030701       0.0019565             3.21      
     7         88          0.030701     0.000489125             3.21      
     8         99          0.030701     0.000122281             3.21      
     9        110          0.030701     3.49807e-05             3.21      
    10        121          0.030701     7.64259e-06             3.21      
    11        132          0.030701     1.91065e-06             3.21      
    12        143          0.030701     4.77662e-07             3.21      
    13        154          0.030701     1.19415e-07             5.35      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           9097.23                         2.97e+03
     1         22           6158.99              10              512      
     2         33           5352.32              20              123      
     3         44            5260.8         38.3386              144      
     4         55           5136.79         76.6301              237      
     5         66           3921.59         156.579              786      
     6         77           1513.31         109.534              527      
     7         88            527.35         46.8512              252      
     8         99           145.751         21.7919              100      
     9        110           34.2728         12.4259              152      
    10        121           5.93178         6.70567             9.72      
    11        132            0.8131         4.62301             18.8      
    12        143          0.234048         14.2199             16.7      
    13        154          0.039564         2.15129             4.85      
    14        165         0.0309186        0.540074             1.17      
    15        176         0.0307117         4.39376           0.0763      
    16        187         0.0307107        0.276685             3.98      
    17        198         0.0307101       0.0691713             2.72      
    18        209         0.0307101       0.0172928             2.72      
    19        220         0.0307101      0.00432321             2.72      
    20        231         0.0307101       0.0010808             2.72      
    21        242         0.0307101       0.0002702             2.72      
    22        253         0.0307101     6.75501e-05             2.72      
    23        264         0.0307101     1.68875e-05             2.72      
    24        275         0.0307101     4.22188e-06             2.72      
    25        286         0.0307101     1.05547e-06             2.72      
    26        297         0.0307101     2.63868e-07             3.34      
    27        308         0.0307101     6.59669e-08             0.19      
    28        319         0.0307101     1.64917e-08             0.19      
    29        330         0.0307101     4.12293e-09             0.19      

优化已停止，因为当前步长的范数 4.122931e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6508.75                         2.77e+03
     1         22           5732.92              10         1.25e+03      
     2         33           4757.15              20              842      
     3         44           4046.06              40              758      
     4         55           2653.55              80              710      
     5         66           959.388         72.2716              370      
     6         77           293.215         31.4485              159      
     7         88            73.091          14.651             58.8      
     8         99           13.5691         7.67461             18.2      
     9        110           2.09738         7.73648             69.5      
    10        121          0.398762         7.99091             48.7      
    11        132         0.0913277         3.40187               17      
    12        143         0.0324754         2.42419             4.35      
    13        154         0.0307746        0.778469            0.369      
    14        165         0.0307403         7.53077               27      
    15        176          0.030736       0.0518102             2.16      
    16        187          0.030736       0.0129525             2.16      
    17        198          0.030736      0.00323813             2.16      
    18        209          0.030736     0.000809534             2.16      
    19        220          0.030736     0.000202383             2.16      
    20        231          0.030736     5.05959e-05             2.16      
    21        242          0.030736      1.2649e-05             2.16      
    22        253          0.030736     3.16224e-06             2.16      
    23        264          0.030736      7.9056e-07             2.16      
    24        275          0.030736      1.9764e-07          0.00263      
    25        286          0.030736      1.9764e-07          0.00263      
    26        297          0.030736       4.941e-08          0.00263      
    27        308          0.030736     1.23525e-08          0.00263      
    28        319          0.030736     3.08813e-09          0.00263      

优化已停止，因为当前步长的范数 3.088126e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5747.32                         2.02e+03
     1         22           5064.52              10         1.16e+03      
     2         33           4251.55              20              860      
     3         44           3542.69              40              781      
     4         55           1772.14         84.3107              563      
     5         66           598.822         47.3945              265      
     6         77            168.63         21.6249              107      
     7         88           39.0728         10.6898             36.7      
     8         99            6.5921         5.91103              135      
     9        110          0.990887         2.91839             49.9      
    10        121          0.192721         1.60221               22      
    11        132          0.184925      0.00422379                1      
    12        143         0.0421162         1.19622             4.27      
    13        154         0.0310936         1.65056            0.178      
    14        165         0.0307128         8.33635             5.19      
    15        176         0.0307128         2.11615             5.19      
    16        187         0.0307113        0.529037             8.54      
    17        198         0.0307109        0.132259           0.0241      
    18        209         0.0307109       0.0330648           0.0241      
    19        220         0.0307109       0.0082662           0.0241      
    20        231         0.0307109      0.00206655           0.0241      
    21        242         0.0307109     0.000516638           0.0241      
    22        253         0.0307109     0.000129159           0.0241      
    23        264         0.0307109     3.22899e-05           0.0241      
    24        275         0.0307109     8.07246e-06           0.0241      
    25        286         0.0307109     2.01812e-06           0.0241      
    26        297         0.0307109     5.04529e-07           0.0241      
    27        308         0.0307109     1.26132e-07           0.0241      
    28        319         0.0307109     3.15331e-08           0.0241      
    29        330         0.0307109     7.88326e-09           0.0241      

优化已停止，因为当前步长的范数 7.883264e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           4022.27                         1.03e+03
     1         22           3552.83              10              855      
     2         33           3107.74              20              759      
     3         44           2403.46         38.3229              673      
     4         55           292.216         77.3649              158      
     5         66           72.9245         22.2014             58.1      
     6         77           13.5268         11.7603             17.8      
     7         88           2.19036         3.80291              105      
     8         99          0.399179         7.66662             59.3      
     9        110         0.0941895         2.70221             16.5      
    10        121         0.0366831         7.66592              340      
    11        132         0.0307706         2.63886             51.1      
    12        143         0.0307206         1.90148             30.8      
    13        154         0.0307166        0.475371          0.00418      
    14        165         0.0307151        0.118843            0.209      
    15        176         0.0307116       0.0297107          0.00306      
    16        187         0.0307116       0.0297107          0.00306      
    17        198         0.0307116      0.00742767          0.00306      
    18        209         0.0307116      0.00185692          0.00306      
    19        220         0.0307116     0.000464229          0.00306      
    20        231         0.0307116     0.000116057          0.00306      
    21        242         0.0307116     2.90143e-05          0.00306      
    22        253         0.0307116     7.25358e-06          0.00306      
    23        264         0.0307116      1.8134e-06          0.00306      
    24        275         0.0307116     4.53349e-07          0.00197      
    25        286         0.0307116     4.53349e-07          0.00197      
    26        297         0.0307116     1.13337e-07            0.223      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.21%, 最大相对误差 = 102.83%
Trust-Region-Reflective: 平均相对误差 = 4.22%, 最大相对误差 = 102.99%

Levenberg-Marquardt: 负区域误差 = 1.04%, 正区域误差 = 6.22%
Trust-Region-Reflective: 负区域误差 = 1.04%, 正区域误差 = 6.22%
整体表现更好: Levenberg-Marquardt算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11         0.030701         0.00187         0.01
     1          25        0.0307009         0.00258           10    0.000171037
     2          36        0.0307009         0.00228            1    0.000220245
     3          49        0.0307008        0.000941          100    2.74829e-05
     4          60        0.0307008        0.000333           10    9.63881e-06
     5          72        0.0307008         0.00248          100    3.47083e-06

优化已停止，因为当前步长的相对范数 4.194147e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 103.26%
平均相对误差: 4.22%
平均误差 4.22% 低于阈值，结束优化。

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0332414           0.041         0.01
     1          22         0.030223         0.00533        0.001      0.0826129
     2          33        0.0301723         0.00269       0.0001       0.057358
     3          44        0.0301603         0.00191        1e-05       0.061118
     4          57        0.0301594         0.00213        0.001      0.0266554
     5          64                                                   2.261e-06

优化已停止，因为当前步长的相对范数 2.732198e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11           5572.9         0.00894         0.01
     1          22          5253.75        7.98e-06        0.001        147.228
     2          33          5251.67        8.28e-06       0.0001        132.483
     3          44          5249.02        3.33e-08        1e-05        350.468
     4          55          5248.15        3.38e-08        1e-06        244.415
     5          66          5239.13        3.93e-08        1e-07        2102.42
     6          77          5078.55           0.222        1e-08        22149.1
     7          88          2922.15             282        1e-09        55127.5
     8          99          1024.11            32.1        1e-10        47.4708
     9         110           279.25            12.8        1e-11        682.665
    10         121          121.543             809        1e-12        230.183
    11         132          29.0361             116        1e-13         3.1711
    12         143           23.592            92.6        1e-14        5.88031
    13         154          4.59551            10.9        1e-15        14.6984
    14         165           1.5657            0.93        1e-16        14.5931
    15         176         0.192257           0.155        1e-17        7.01384
    16         187        0.0531729           0.052        1e-18         4.6259
    17         198        0.0486531          0.0207        1e-19       0.280552
    18         225        0.0467025          0.0575        0.001        1.33296
    19         236         0.038333          0.0198       0.0001        1.09734
    20         247        0.0372908         0.00642        1e-05       0.413268
    21         260        0.0362813         0.00342        0.001       0.719058
    22         271        0.0359022         0.00443       0.0001       0.291461
    23         282        0.0354707         0.00554        1e-05       0.594331
    24         293        0.0345799         0.00438        1e-06        1.06589
    25         306        0.0336599          0.0167       0.0001        2.49517
    26         317        0.0327121         0.00629        1e-05        2.21435
    27         328        0.0326541         0.00133        1e-06      0.0487405
    28         343        0.0326528         0.00117         0.01      0.0150393
    29         357        0.0326527         0.00189           10    0.000121148
    30         368        0.0326525         0.00132            1    0.000148482
    31         373                                                 1.80854e-07

优化已停止，因为当前步长的相对范数 6.952256e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11             6884           0.094         0.01
     1          22          5248.35        8.67e-06        0.001        229.032
     2          33          5246.34        3.48e-08       0.0001        132.355
     3          44          5246.24        3.49e-08        1e-05        129.791
     4          55          5245.33        3.55e-08        1e-06        249.029
     5          66          5235.89        4.14e-08        1e-07        2149.93
     6          77          5065.35        3.58e-07        1e-08        28429.3
     7          88          3001.28             312        1e-09         325820
     8          99          1050.08            32.7        1e-10        328.361
     9         110          315.924            11.2        1e-11       0.611933
    10         121          78.5686            84.4        1e-12        18.4133
    11         132          13.8691            16.7        1e-13        491.935
    12         143          1.56499            2.43        1e-14        11.0786
    13         154        0.0977691           0.295        1e-15        127.162
    14         165        0.0307211          0.0124        1e-16        50.8947
    15         176        0.0301916         0.00529        1e-17        420.489
    16         201        0.0301858        0.000666        0.001       0.103437
    17         212          0.03018         0.00262       0.0001      0.0198477
    18         223        0.0301766        0.000773        1e-05      0.0258279
    19         237         0.030176         0.00412         0.01      0.0164942
    20         249        0.0301759         0.00374          0.1     0.00321526
    21         260        0.0301749        0.000597         0.01     0.00279186
    22         271        0.0301746         0.00134        0.001      0.0107816
    23         288        0.0301746         0.00117         1000    1.35361e-06

优化已停止，因为当前步长的相对范数 2.557442e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6109.93          0.0623         0.01
     1          22          5171.51        2.53e-05        0.001         167.54
     2          33          5170.39        1.07e-07       0.0001        132.797
     3          44          5170.12        1.08e-07        1e-05        126.912
     4          55          5167.67        1.11e-07        1e-06        419.847
     5          66          5138.42         1.6e-07        1e-07        3726.92
     6          77          3357.82        0.000181        1e-08          41748
     7          88          197.456             145        1e-09          48564
     8          99          72.9696            76.7        1e-10         31.341
     9         110          19.6796            31.1        1e-11        6.75203
    10         121          4.41744            6.61        1e-12        18.6707
    11         132          1.59465            1.12        1e-13         6.4771
    12         157          1.38783            0.89           10       0.119175
    13         168          1.22109            0.75            1       0.103241
    14         179         0.745258           0.232          0.1       0.531597
    15         190          0.35426          0.0794         0.01        1.19634
    16         201         0.164826          0.0746        0.001        1.95011
    17         212        0.0785173          0.0469       0.0001        4.37533
    18         223        0.0416632          0.0225        1e-05        2.40438
    19         234         0.036981         0.00709        1e-06        1.07953
    20         245        0.0365891           0.034        1e-07        2.65655
    21         256        0.0343628         0.00544        1e-08       0.574129
    22         267        0.0340496         0.00449        1e-09       0.326895
    23         278        0.0337347        0.000757        1e-10       0.662788
    24         297        0.0337346          0.0012         0.01      0.0200659
    25         308        0.0337072         0.00084        0.001      0.0598367
    26         319        0.0336183          0.0035       0.0001       0.229834
    27         330        0.0332667         0.00404        1e-05       0.863065
    28         341         0.032875          0.0196        1e-06        4.14758
    29         353        0.0321419          0.0201        1e-05         7.6254
    30         364        0.0315979         0.00289        1e-06        1.93225
    31         381        0.0315964         0.00396            1     0.00214171
    32         392        0.0315949          0.0015          0.1    0.000999124
    33         407        0.0315949         0.00126         1000     1.4995e-06
    34         418        0.0315949        0.000776          100    1.28739e-06
    35         421                                                 8.90881e-08

优化已停止，因为当前步长的相对范数 2.891094e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5267.69          0.0076         0.01
     1          22          5052.82        7.99e-05        0.001        116.371
     2          33          5047.45        4.28e-07       0.0001        142.914
     3          44          5046.39        4.33e-07        1e-05        129.688
     4          55          5036.73        4.76e-07        1e-06        744.034
     5          66          4911.62        1.32e-06        1e-07        7048.29
     6          77             2974             299        1e-08        87631.3
     7          88          1044.22            33.9        1e-09        121.243
     8          99           313.74            11.2        1e-10        231.124
     9         110          75.7959            83.5        1e-11        142.554
    10         121          13.6427            17.3        1e-12        408.269
    11         132          1.50578            2.61        1e-13        553.356
    12         143        0.0871081           0.303        1e-14        126.667
    13         154        0.0305073          0.0127        1e-15        94.3088
    14         165        0.0301943        0.000669        1e-16        28.9277
    15         185                                                 7.09626e-07

优化已停止，因为当前步长的相对范数 1.837216e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11         0.0301595                             2.82
     1         22         0.0301595         7.11452             2.82      
     2         33         0.0301595         1.77863             2.82      
     3         44         0.0301595        0.444657             2.82      
     4         55         0.0301593        0.111164            0.585      
     5         66         0.0301593       0.0277911             3.87      
     6         77         0.0301593      0.00694777             3.87      
     7         88         0.0301593      0.00173694             3.87      
     8         99         0.0301593     0.000434236             3.87      
     9        110         0.0301593     0.000108559             3.87      
    10        121         0.0301593     2.71397e-05             3.87      
    11        132         0.0301593     6.78493e-06          0.00206      
    12        143         0.0301593     1.69623e-06          0.00216      
    13        154         0.0301593     1.69623e-06            0.113      
    14        165         0.0301593     1.69623e-06            0.113      
    15        176         0.0301593     4.24058e-07            0.113      
    16        187         0.0301593     1.06015e-07          0.00251      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6368.54                         1.14e+03
     1         22           5207.56              10              521      
     2         33           4861.72         19.7871              472      
     3         44           4592.72         38.6477              615      
     4         55           3780.58         70.8489              783      
     5         66           2231.02              80              667      
     6         77            784.23         60.3565              331      
     7         88           231.753         45.0887              139      
     8         99            55.918         19.0528             49.7      
     9        110           9.95518         9.76714             14.8      
    10        121            1.6833          25.829               97      
    11        132          0.375895         1.90684             41.9      
    12        143         0.0591467         3.59179             13.9      
    13        154           0.03129        0.651001             2.42      
    14        165         0.0305479         2.47892            0.426      
    15        176         0.0304962        0.205032             19.3      
    16        187         0.0304962         1.10041             19.3      
    17        198         0.0304962        0.275103             19.3      
    18        209         0.0304941       0.0687758          0.00183      
    19        220         0.0304941       0.0093011          0.00183      
    20        231         0.0304941      0.00232528          0.00183      
    21        242         0.0304941     0.000581319          0.00183      
    22        253          0.030494      0.00014533             6.63      
    23        264          0.030494     3.63324e-05             6.63      
    24        275          0.030494     9.08311e-06             7.76      
    25        286          0.030494     2.27078e-06             7.76      
    26        297          0.030494     5.67694e-07             7.76      
    27        308          0.030494     1.41924e-07          0.00645      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6763.19                         1.12e+03
     1         22           5368.45              10              412      
     2         33           5004.18         19.7917              362      
     3         44           4809.37         38.5497              497      
     4         55           4098.64         76.6574              753      
     5         66           1148.49         124.684              430      
     6         77           361.701         35.9009              189      
     7         88           93.6649         17.5898             71.6      
     8         99           93.6649         14.4718             71.6      
     9        110            60.012         3.61796             52.3      
    10        121           11.2381         7.59099              186      
    11        132           2.81186         14.4718             43.1      
    12        143          0.531895         3.96104             30.9      
    13        154          0.216303         4.06815             20.6      
    14        165         0.0341942         1.91873              109      
    15        176         0.0302583         2.81725             22.6      
    16        187         0.0302271        0.653871             10.8      
    17        198         0.0302173        0.224804             1.23      
    18        209         0.0302173       0.0935618             1.23      
    19        220         0.0302149       0.0233905            0.164      
    20        231         0.0302149      0.00584761            0.164      
    21        242         0.0302149       0.0014619            0.164      
    22        253         0.0302149     0.000365476            0.164      
    23        264         0.0302149      9.1369e-05            0.164      
    24        275         0.0302147     2.28422e-05           0.0599      
    25        286         0.0302147     2.28422e-05           0.0599      
    26        297         0.0302147     5.71056e-06           0.0599      
    27        308         0.0302147     1.42764e-06           0.0599      
    28        319         0.0302147      3.5691e-07           0.0599      
    29        330         0.0302147     8.92275e-08           0.0599      
    30        341         0.0302147     2.23069e-08           0.0599      
    31        352         0.0302147     5.57672e-09           0.0599      

优化已停止，因为当前步长的范数 5.576719e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           7687.58                         1.58e+03
     1         22           5749.51              10              337      
     2         33           5165.72              20              244      
     3         44           5035.68         38.4286              322      
     4         55           4604.63         77.6411              616      
     5         66           1749.26         145.169              574      
     6         77           623.796         51.4816              282      
     7         88           177.143          25.441              114      
     8         99           41.7768         12.4017             39.2      
     9        110           7.23665         6.69011              207      
    10        121           1.12856         3.41334             72.4      
    11        132          0.259074         3.04434             29.5      
    12        143         0.0484794         11.6675             9.31      
    13        154         0.0305272         10.5909             1.41      
    14        165         0.0301649        0.180725            0.066      
    15        176         0.0301649         4.16682            0.066      
    16        187         0.0301649          1.0417            0.066      
    17        198         0.0301649        0.260426            0.066      
    18        209         0.0301649       0.0651065            0.066      
    19        220         0.0301649       0.0162766            0.066      
    20        231         0.0301649      0.00406916            0.066      
    21        242         0.0301649      0.00101729            0.066      
    22        253         0.0301649     0.000254322            0.066      
    23        264         0.0301649     6.35806e-05            0.066      
    24        275         0.0301649     1.58951e-05            0.066      
    25        286         0.0301649     3.97379e-06            0.163      
    26        297         0.0301649     3.97379e-06            0.163      
    27        308         0.0301649     9.93447e-07            0.163      
    28        319         0.0301649     2.48362e-07            0.163      
    29        330         0.0301649     6.20904e-08             1.82      
    30        341         0.0301649     6.20904e-08             1.82      
    31        352         0.0301649     1.55226e-08             1.82      
    32        363         0.0301649     3.88065e-09             1.82      

优化已停止，因为当前步长的范数 3.880651e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           7853.23                         1.97e+03
     1         22           5689.95              10              205      
     2         33           5323.89         9.86581              112      
     3         44           5292.43          19.061              121      
     4         55           5254.43         38.1202              146      
     5         66           5129.66          76.369              243      
     6         77           4175.57         140.396              754      
     7         88           928.247          134.96              378      
     8         99            282.01          30.308              162      
     9        110           70.8338         14.8934               59      
    10        121            13.577         7.99085              398      
    11        132           2.33535         4.12145              185      
    12        143          0.476327         2.26442             67.2      
    13        154           0.42978      0.00750632             1.15      
    14        165          0.331262        0.513492             58.1      
    15        176          0.042343         1.81828              213      
    16        187         0.0303702         10.3875             9.07      
    17        198         0.0301656         3.86775              1.5      
    18        209         0.0301652         0.70449            0.113      
    19        220         0.0301605        0.176122          0.00282      
    20        231         0.0301605       0.0197074          0.00282      
    21        242         0.0301605      0.00492686          0.00282      
    22        253         0.0301605      0.00123171          0.00282      
    23        264         0.0301605     0.000307929          0.00282      
    24        275         0.0301604     7.69821e-05           0.0603      
    25        286         0.0301604     1.92455e-05           0.0603      
    26        297         0.0301604     4.81138e-06           0.0603      
    27        308         0.0301604     1.20285e-06           0.0603      
    28        319         0.0301604     3.00712e-07           0.0603      
    29        330         0.0301604     7.51779e-08           0.0603      
    30        341         0.0301604     1.87945e-08           0.0603      
    31        352         0.0301604     4.69862e-09           0.0603      

优化已停止，因为当前步长的范数 4.698617e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.15%, 最大相对误差 = 103.22%
Trust-Region-Reflective: 平均相对误差 = 4.15%, 最大相对误差 = 102.82%

Levenberg-Marquardt: 负区域误差 = 0.96%, 正区域误差 = 6.17%
Trust-Region-Reflective: 负区域误差 = 0.96%, 正区域误差 = 6.17%
整体表现更好: Trust-Region-Reflective算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0301593         0.00321         0.01
     1          24        0.0301588        0.000639            1     0.00227744
     2          37        0.0301588         0.00211          100    6.60258e-06

优化已停止，因为当前步长的相对范数 8.005932e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 103.29%
平均相对误差: 4.15%
平均误差 4.15% 低于阈值，结束优化。

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0327865          0.0379         0.01
     1          22        0.0299096         0.00531        0.001      0.0809936
     2          33        0.0298246         0.00234       0.0001       0.118286
     3          44        0.0298093         0.00332        1e-05      0.0778063
     4          55        0.0298091          0.0015        1e-06       0.068433
     5          73         0.029809         0.00174           10    0.000138023
     6          84        0.0298085        0.000256            1    0.000188487
     7          87                                                 2.92701e-06

优化已停止，因为当前步长的相对范数 3.549379e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6333.41           0.365         0.01
     1          22          4905.97        0.000236        0.001        33.3978
     2          33          4886.68        1.58e-06       0.0001        174.752
     3          44          4882.84        1.63e-06        1e-05        169.292
     4          55             4852           2e-06        1e-06        1217.03
     5          66          4314.83        1.92e-05        1e-07        12689.1
     6          77           3007.7             321        1e-08          85030
     7          88          1053.24            34.6        1e-09        326.109
     8          99          318.083            11.1        1e-10        95.4321
     9         110          78.1684              82        1e-11        126.363
    10         125          13.6831            17.1        1e-07        740.529
    11         136           1.5036            2.56        1e-08        49.5696
    12         147        0.0844649           0.278        1e-09        189.658
    13         158         0.030244          0.0113        1e-10        36.0632
    14         169        0.0298313         0.00207        1e-11        29.1278
    15         189        0.0298291         0.00303         0.01       0.012194
    16         202        0.0298284         0.00221            1     0.00148341
    17         213        0.0298277         0.00306          0.1    0.000607813
    18         226        0.0298277        0.000545           10    0.000291361
    19         237        0.0298276         0.00238            1    5.79487e-05
    20         251        0.0298276         0.00198         1000    2.81134e-06

优化已停止，因为当前步长的相对范数 5.715557e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5473.99          0.0237         0.01
     1          22          5066.02        7.77e-05        0.001        124.622
     2          33          5065.83        3.57e-07       0.0001        143.544
     3          44          5064.98         3.6e-07        1e-05        127.593
     4          55           5056.7        3.92e-07        1e-06         670.59
     5          66          4977.82        0.000146        1e-07        6477.91
     6          77          4965.72        4.75e-05        1e-08        36850.5
     7          88          428.489            6.06        1e-09         299709
     8          99          138.229             749        1e-10         581.14
     9         110          39.6861             124        1e-11         28.939
    10         121          15.4177            16.8        1e-12        18.8989
    11         132          9.80069            80.8        1e-13        7.08662
    12         143          5.05753            10.3        1e-14        14.3213
    13         154          1.17197            2.93        1e-15        15.7805
    14         165         0.557107           0.688        1e-16        7.08224
    15         176         0.170238            0.16        1e-17         31.647
    16         187        0.0332196          0.0807        1e-18        18.0679
    17         198        0.0304307         0.00408        1e-19         19.384
    18         223        0.0304113         0.00325        1e-05        1.33016
    19         234        0.0303414         0.00571        1e-06         3.7881
    20         245        0.0303336         0.00272        1e-07       0.534692
    21         261        0.0303327         0.00183         0.01      0.0171428
    22         272         0.030331          0.0015        0.001      0.0123659
    23         285        0.0303308         0.00173          0.1     0.00276603
    24         299        0.0303308         0.00209          100    1.77232e-05
    25         310        0.0303308         0.00244           10     2.3843e-05
    26         321        0.0303307         0.00215            1    0.000234262
    27         335        0.0303307         0.00272         1000    2.21145e-06
    28         337                                                 2.78876e-07

优化已停止，因为当前步长的相对范数 5.476075e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          8442.94           0.266         0.01
     1          22          5201.16        1.55e-05        0.001        23.5069
     2          33          5200.41         7.1e-08       0.0001        131.264
     3          44          5200.23        5.46e-06        1e-05        127.822
     4          55          5198.58        7.28e-08        1e-06        2375.34
     5          66          5179.35        8.02e-07        1e-07        3120.52
     6          77          4549.47        1.68e-05        1e-08        34712.2
     7          88          428.499            6.08        1e-09         197272
     8          99          219.742            15.8        1e-10         2352.5
     9         110          50.5215            83.8        1e-11        4.73457
    10         121          7.44114            11.3        1e-12         79.299
    11         132         0.645014            1.65        1e-13        290.584
    12         143        0.0442933           0.182        1e-14        44.0042
    13         154        0.0298272         0.00558        1e-15        4.66379
    14         172        0.0298215         0.00168        1e-08        100.487
    15         189        0.0298212         0.00106         0.01      0.0103019
    16         205        0.0298212         0.00111         1000    1.11108e-06

优化已停止，因为当前步长的相对范数 1.949517e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11           5422.1          0.0765         0.01
     1          22          4880.32        0.000275        0.001        102.554
     2          33          4860.81        3.34e-05       0.0001         181.66
     3          53          4860.81        1.87e-06       100000    0.000888892

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11         0.0298085                             5.49
     1         22         0.0298085         2.60628             5.49      
     2         33          0.029806         0.65157             4.32      
     3         44          0.029806        0.162892             4.32      
     4         55          0.029806       0.0407231             4.32      
     5         66          0.029806       0.0101808             4.32      
     6         77          0.029806      0.00254519             4.32      
     7         88          0.029806     0.000636299             4.32      
     8         99          0.029806     0.000159075             4.32      
     9        110          0.029806     3.97687e-05             4.32      
    10        121         0.0298059     9.94217e-06           0.0879      
    11        132         0.0298059     2.48554e-06           0.0879      
    12        143         0.0298059     6.21385e-07           0.0879      
    13        154         0.0298059     1.55346e-07           0.0879      
    14        165         0.0298059     3.88366e-08            0.144      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11            7230.1                         1.26e+03
     1         22           5521.21              10              291      
     2         33           5140.33         19.7935              250      
     3         44           5018.82         38.3837              337      
     4         55           4569.13         77.6537              634      
     5         66           1888.32         141.017              607      
     6         77           648.481         55.5414              291      
     7         88           44.1303         36.5465         1.84e+05      
     8         99           19.2124      0.00949976         8.87e+04      
     9        110           3.27077         2.62064         1.32e+04      
    10        121           0.39911         10.0015         1.59e+03      
    11        132         0.0519496         4.77687               83      
    12        143         0.0301189         2.29522             58.4      
    13        154         0.0298212        0.241367           0.0947      
    14        165         0.0298189         6.99344             23.4      
    15        176         0.0298098         1.74836             11.1      
    16        187          0.029807         0.43709         0.000751      
    17        198         0.0298062        0.109273            0.313      
    18        209         0.0298061        0.109273          0.00215      
    19        220         0.0298061       0.0273181          0.00215      
    20        231         0.0298061      0.00682954          0.00215      
    21        242         0.0298061      0.00187405          0.00215      
    22        253         0.0298059     0.000426846             3.96      
    23        264         0.0298059     0.000106712             3.67      
    24        275         0.0298059     2.66779e-05             3.67      
    25        286         0.0298059     6.66947e-06             3.67      
    26        297         0.0298059     1.66737e-06             3.67      
    27        308         0.0298059     4.16842e-07             3.67      
    28        319         0.0298059      1.0421e-07             3.67      
    29        330         0.0298059     2.60526e-08             3.67      
    30        341         0.0298059     6.51315e-09             3.67      

优化已停止，因为当前步长的范数 6.513153e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5204.19                              552
     1         22           4886.58         9.89925              453      
     2         33           4769.37         19.1661              518      
     3         44           4499.54         36.1486              647      
     4         55           3470.14              80              779      
     5         66           707.407         104.613              301      
     6         77           205.112         28.3213              124      
     7         88           48.4686         12.8382             43.7      
     8         99           8.34432         7.00803             12.7      
     9        110           1.26487         3.51918             34.4      
    10        121          0.198829         2.53313             32.3      
    11        132         0.0410523         2.20469             5.19      
    12        143         0.0298514         40.2524             24.1      
    13        154         0.0298126        0.690003           0.0375      
    14        165         0.0298126         4.24524           0.0375      
    15        176         0.0298116         1.06131            0.249      
    16        187         0.0298116        0.265328            0.249      
    17        198         0.0298116        0.066332            0.249      
    18        209         0.0298116        0.016583            0.249      
    19        220         0.0298116      0.00414575            0.249      
    20        231         0.0298116      0.00103644            0.249      
    21        242         0.0298116     0.000259109            0.249      
    22        253         0.0298116     7.65708e-05            0.249      
    23        264         0.0298116     1.61943e-05            0.249      
    24        275         0.0298116     4.04858e-06            0.857      
    25        286         0.0298116     1.01215e-06            0.857      
    26        297         0.0298116     2.53036e-07             4.06      
    27        308         0.0298116     2.53036e-07             4.06      
    28        319         0.0298116     6.32591e-08             4.06      
    29        330         0.0298116     1.58148e-08             4.06      
    30        341         0.0298116     3.95369e-09            0.185      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6635.31                              891
     1         22           5389.69              10              161      
     2         33           5247.91         9.64479              155      
     3         44           5216.84         19.0557              172      
     4         55            5152.2         38.0179              222      
     5         66           4882.11              80              445      
     6         77           1745.55         171.501              573      
     7         88           589.148         47.2919              270      
     8         99           165.694         21.6888              109      
     9        110           38.3653         12.7079             37.2      
    10        121           4.70377          12.329         2.01e+04      
    11        132           1.20738        0.363862         1.96e+03      
    12        143          0.340817         12.9915              111      
    13        154         0.0700487         5.37197              173      
    14        165         0.0309578        0.742945             5.17      
    15        176         0.0299952        0.860827             6.99      
    16        187         0.0299429        0.477647          0.00919      
    17        198         0.0299296        0.450624             11.5      
    18        209         0.0299274        0.112656            0.107      
    19        220         0.0299274       0.0266026            0.107      
    20        231         0.0299248      0.00665064           0.0707      
    21        242         0.0299248      0.00665064           0.0707      
    22        253         0.0299248      0.00166266           0.0707      
    23        264         0.0299248     0.000415665           0.0707      
    24        275         0.0299248     0.000103916           0.0707      
    25        286         0.0299248     2.59791e-05           0.0707      
    26        297         0.0299248     6.49477e-06           0.0707      
    27        308         0.0299248     1.62369e-06             4.87      
    28        319         0.0299248     4.05923e-07             4.87      
    29        330         0.0299248     1.01481e-07             4.87      
    30        341         0.0299248     2.53702e-08             4.87      
    31        352         0.0299248     6.34255e-09           0.0225      

优化已停止，因为当前步长的范数 6.342549e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           3092.86                              799
     1         22           2750.43              10              703      
     2         33           2327.02         19.3966              628      
     3         44           1460.83              40              486      
     4         55            480.82         42.9499              222      
     5         66           131.033         27.2026             87.4      
     6         77           28.3484         13.6185             29.3      
     7         88           4.23896         6.87571              8.1      
     8         99          0.644041         11.7523             17.5      
     9        110          0.231209         5.65189             18.8      
    10        121          0.035502         6.66552             25.3      
    11        132         0.0298937        0.863508             24.1      
    12        143         0.0298202         5.79125               20      
    13        154         0.0298125         1.44781             1.47      
    14        165         0.0298123        0.361953             1.45      
    15        176         0.0298123       0.0904883             1.45      
    16        187         0.0298123       0.0226221             1.45      
    17        198         0.0298123      0.00565552             1.45      
    18        209         0.0298123      0.00141388             1.45      
    19        220         0.0298123      0.00035347             1.45      
    20        231         0.0298123     8.83675e-05             1.45      
    21        242         0.0298123     2.20919e-05             1.45      
    22        253         0.0298123     5.52297e-06             1.45      
    23        264         0.0298123     1.38074e-06             1.45      
    24        275         0.0298123     3.45185e-07             1.19      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.16%, 最大相对误差 = 103.07%
Trust-Region-Reflective: 平均相对误差 = 4.16%, 最大相对误差 = 103.29%

Levenberg-Marquardt: 负区域误差 = 1.02%, 正区域误差 = 6.09%
Trust-Region-Reflective: 负区域误差 = 1.01%, 正区域误差 = 6.09%
整体表现更好: Trust-Region-Reflective算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0298059         0.00234         0.01
     1          25        0.0298058         0.00212           10    0.000255383
     2          36        0.0298057         0.00273            1    0.000222678
     3          48        0.0298056        0.000929           10    0.000279908
     4          59        0.0298056         0.00177            1    8.22713e-05
     5          73        0.0298056         0.00123         1000    1.99986e-06

优化已停止，因为当前步长的相对范数 2.373131e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 103.29%
平均相对误差: 4.16%
平均误差 4.16% 低于阈值，结束优化。

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0407466          0.0756         0.01
     1          22        0.0299465         0.00693        0.001       0.173888
     2          33        0.0296722         0.00168       0.0001       0.188356
     3          44        0.0296523         0.00138        1e-05      0.0837851
     4          57         0.029652         0.00275        0.001      0.0106053
     5          68        0.0296352         0.00188       0.0001      0.0586813
     6          84        0.0296352         0.00211           10    0.000141149
     7          95        0.0296349        0.000551            1    0.000206679
     8         106        0.0296346          0.0014          0.1    0.000355596
     9         117        0.0296341        0.000872         0.01     0.00207309
    10         129        0.0296341         0.00219          0.1     0.00171668
    11         141        0.0296336        0.000358            1     0.00106997
    12         152        0.0296335         0.00214          0.1    0.000385702
    13         165        0.0296334         0.00131           10    0.000211499
    14         168                                                 1.33295e-06

优化已停止，因为当前步长的相对范数 1.616254e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          7913.86           0.311         0.01
     1          22          5131.33         3.7e-05        0.001        29.4344
     2          33          5129.88        1.77e-07       0.0001        133.956
     3          44          5129.45        1.78e-07        1e-05        125.355
     4          55          5125.15        6.98e-07        1e-06        475.631
     5          66          5076.32         3.2e-07        1e-07        4699.79
     6          77          2721.17             226        1e-08          56437
     7          88          794.031            15.9        1e-09        258.413
     8          99          208.535            17.4        1e-10        36.5047
     9         110          45.7715            76.8        1e-11        12.8673
    10         121          6.66396            10.7        1e-12        62.6792
    11         132         0.563803             1.6        1e-13        46.3712
    12         143        0.0391075           0.153        1e-14        4.68629
    13         154        0.0297458         0.00248        1e-15        10.3629
    14         165        0.0297375        0.000372        1e-16        1.72318
    15         187        0.0297371         0.00062        1e-05      0.0416984
    16         199        0.0297368          0.0019       0.0001       0.120326
    17         212        0.0297366         0.00116         0.01      0.0157483
    18         223        0.0297343         0.00246        0.001     0.00486326
    19         238        0.0297343         0.00213           10    0.000223755
    20         252        0.0297343         0.00141        10000    2.96594e-07

优化已停止，因为当前步长的相对范数 1.830086e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6235.38          0.0399         0.01
     1          22          5309.93        2.98e-06        0.001        198.521
     2          33          5309.92        1.03e-08       0.0001        135.066
     3          44          5309.89        1.04e-08        1e-05        134.213
     4          55          5309.61        1.04e-08        1e-06        178.178
     5          66          5306.78        1.11e-08        1e-07        1188.46
     6          77          5271.89        2.22e-08        1e-08        12125.7
     7          88          2975.65             300        1e-09         161151
     8          99          1017.46            31.3        1e-10        352.795
     9         110          302.201            11.8        1e-11        110.533
    10         121          121.427             812        1e-12        1126.58
    11         132          29.0139             116        1e-13        3.24538
    12         156           10.047            13.8            1       0.945457
    13         167          2.26453            2.83          0.1       0.674536
    14         178         0.554164           0.702         0.01       0.766653
    15         189         0.274831           0.147        0.001        1.17292
    16         200         0.199193          0.0541       0.0001         2.6126
    17         211        0.0744398          0.0616        1e-05        10.0952
    18         222        0.0537641          0.0535        1e-06        2.73152
    19         233        0.0509455          0.0206        1e-07       0.198325
    20         248        0.0459392          0.0562        0.001        1.26822
    21         259        0.0397499         0.00364       0.0001       0.730787
    22         271        0.0376674          0.0193        0.001        1.21607
    23         282         0.035874         0.00904       0.0001       0.640637
    24         293        0.0352386         0.00239        1e-05       0.583496
    25         306        0.0344725         0.00415        0.001       0.652491
    26         317        0.0340805        0.000802       0.0001       0.485496
    27         328        0.0332231           0.012        1e-05        1.71225
    28         340        0.0321717          0.0126       0.0001        2.29926
    29         351        0.0318559         0.00474        1e-05       0.813626
    30         362        0.0317002          0.0292        1e-06        5.24582
    31         373        0.0309782         0.00141        1e-07        0.59347
    32         386        0.0306912         0.00601        1e-05        5.94791
    33         398        0.0306036         0.00214       0.0001       0.321742
    34         409        0.0305656         0.00154        1e-05        0.66264
    35         420        0.0304159         0.00129        1e-06        4.00063
    36         431        0.0302965         0.00496        1e-07        6.47433
    37         442         0.030179         0.00145        1e-08         7.3428
    38         453        0.0300433         0.00841        1e-09        14.1913
    39         464          0.02997         0.00265        1e-10        3.20508
    40         485        0.0299692         0.00144            1      0.0011872
    41         496        0.0299668         0.00295          0.1     0.00102451
    42         507        0.0299661         0.00207         0.01     0.00303865
    43         518        0.0299629        0.000677        0.001     0.00345348
    44         535        0.0299629         0.00223         1000    6.91929e-07
    45         546        0.0299629        0.000688          100    2.34773e-06
    46         558        0.0299629        0.000323         1000    7.26004e-07
    47         559                                                  4.0932e-07

优化已停止，因为当前步长的相对范数 6.419132e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6393.74          0.0753         0.01
     1          22          5208.25        1.55e-05        0.001         189.33
     2          33          5204.34        1.62e-05       0.0001        131.786
     3          44          5200.57        7.09e-08        1e-05        463.742
     4          55          5198.79        7.96e-06        1e-06        329.531
     5          66          5180.52        9.36e-08        1e-07         6612.2
     6          77          4523.64        9.61e-06        1e-08        33117.9
     7          88          3109.43             343        1e-09         143262
     8          99          1099.59            37.6        1e-10        7.44957
     9         110          331.893            10.5        1e-11        459.406
    10         121          81.2066            77.7        1e-12         108.58
    11         132          14.6635            18.5        1e-13        1154.32
    12         143          1.65071            2.79        1e-14         447.86
    13         154        0.0941238            0.31        1e-15        6.29229
    14         165        0.0300995         0.00628        1e-16         3.0119
    15         176        0.0296332        0.000573        1e-17        0.43519
    16         187        0.0296299         0.00223        1e-18       0.043671
    17         218        0.0296298         0.00144          100     3.1047e-05
    18         229        0.0296298         0.00189           10    1.54422e-05
    19         242        0.0296298        0.000756         1000    1.92156e-06

优化已停止，因为当前步长的相对范数 1.921000e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6418.05           0.255         0.01
     1          22          5005.79        0.000115        0.001        29.7467
     2          33          5002.42         6.5e-07       0.0001        150.256
     3          44          5001.05        2.64e-06        1e-05        131.873
     4          55          4987.74        7.33e-07        1e-06        854.398
     5          66          4789.09        7.04e-05        1e-07        8821.89
     6          77          411.894            5.16        1e-08        95827.9
     7          94          170.896            19.3         0.01        64.5513
     8         105             94.2            65.2        0.001          37.45
     9         116          16.9223              21       0.0001        7.40656
    10         127          1.98827            3.12        1e-05        7.02744
    11         138         0.118822           0.378        1e-06        4.98226
    12         149         0.030319          0.0161        1e-07        1.27723
    13         160        0.0296811         0.00295        1e-08        13.4437
    14         171        0.0296622         0.00273        1e-09        3.31102
    15         191         0.029661         0.00208            1     0.00129744
    16         204         0.029661         0.00135          100    2.54051e-05
    17         206                                                 1.45185e-06

优化已停止，因为当前步长的相对范数 3.707001e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11         0.0296298                           0.0703
     1         22         0.0296298       0.0125323           0.0703      
     2         33         0.0296298      0.00313307           0.0703      
     3         44         0.0296298     0.000783267           0.0703      
     4         55         0.0296298     0.000195817           0.0703      
     5         66         0.0296298     4.89542e-05           0.0703      
     6         77         0.0296298     1.22386e-05            0.191      
     7         88         0.0296298     3.05964e-06            0.191      
     8         99         0.0296298     7.64909e-07           0.0251      
     9        110         0.0296298     1.91227e-07           0.0251      
    10        121         0.0296298     4.78068e-08           0.0251      
    11        132         0.0296298     1.19517e-08            0.871      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6057.83                              453
     1         22           5332.26              10              130      
     2         33           5268.54         19.1249              138      
     3         44           5220.97         38.1533              171      
     4         55           5060.23         76.6415              301      
     5         66           3581.44         150.569              804      
     6         77              1362         96.7837              492      
     7         88           441.056         38.9937              223      
     8         99           118.428          18.289             86.2      
     9        110           27.7115         9.13747              316      
    10        121           4.67001          5.1744             7.84      
    11        132          0.625306         12.0844             1.74      
    12        143          0.192846         4.80105               15      
    13        154         0.0359698         8.11193             2.82      
    14        165         0.0297462         2.04631            0.211      
    15        176         0.0296583         2.33919             19.8      
    16        187         0.0296583        0.380116             19.8      
    17        198         0.0296531       0.0950291           0.0453      
    18        209         0.0296531       0.0237573           0.0453      
    19        220         0.0296531      0.00593932           0.0453      
    20        231         0.0296531      0.00148483           0.0453      
    21        242         0.0296531     0.000371207           0.0453      
    22        253         0.0296531     9.28018e-05           0.0453      
    23        264         0.0296531     2.32005e-05           0.0453      
    24        275         0.0296531     5.80012e-06           0.0453      
    25        286         0.0296531     1.45003e-06           0.0453      
    26        297         0.0296531     3.62507e-07          0.00135      
    27        308         0.0296531     3.62507e-07          0.00135      
    28        319         0.0296531     9.06268e-08          0.00135      
    29        330         0.0296531     2.26567e-08          0.00135      
    30        341         0.0296531     5.66418e-09          0.00135      

优化已停止，因为当前步长的范数 5.664175e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5536.43                              192
     1         22           5242.97         9.79994              165      
     2         33           5203.23         19.0748              183      
     3         44           5132.48          38.126              238      
     4         55           4883.11         71.4962              446      
     5         66            4217.3              80              740      
     6         77           1185.35         133.476              446      
     7         88           375.512         40.5761              197      
     8         99           98.0282         19.4876               75      
     9        110           21.8528         9.65119               30      
    10        121           3.43563         19.5951             6.69      
    11        132          0.522986         7.82644             9.27      
    12        143          0.199349         6.16365             16.3      
    13        154         0.0341128         10.3288             4.18      
    14        165         0.0296721         1.29797             17.7      
    15        176         0.0296477         4.65911            0.102      
    16        187         0.0296477         1.16478            0.102      
    17        198         0.0296477        0.291194            0.102      
    18        209         0.0296477       0.0727986            0.102      
    19        220         0.0296477       0.0181997            0.102      
    20        231         0.0296477      0.00454991            0.102      
    21        242         0.0296477      0.00113748            0.102      
    22        253         0.0296477      0.00028437            0.102      
    23        264         0.0296477     7.10924e-05            0.102      
    24        275         0.0296475     1.77731e-05             0.12      
    25        286         0.0296473     1.77731e-05            0.128      
    26        297         0.0296473     3.98273e-05            0.128      
    27        308         0.0296472     8.88655e-06            0.778      
    28        319         0.0296472     2.22164e-06            0.778      
    29        330         0.0296472     5.55409e-07             0.79      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6373.23                              714
     1         22           5286.76              10              226      
     2         33           5143.63         19.2892              236      
     3         44           5040.08         38.3146              319      
     4         55            4622.4         77.3219              613      
     5         66           3260.17         101.458              798      
     6         77           1220.13         89.2516              458      
     7         88           388.136         41.0915              204      
     8         99           102.135         19.8277             77.6      
     9        110           20.5363         10.1704             57.6      
    10        121           3.47617         5.38639             53.5      
    11        132          0.597906         4.75059             39.8      
    12        143           0.21616          1.3805             17.8      
    13        154          0.199836       0.0077521             10.1      
    14        165         0.0383292         1.13196             4.37      
    15        176         0.0298811         4.02904            0.444      
    16        187         0.0296575         4.93801             23.1      
    17        198         0.0296477          1.0634          0.00331      
    18        209         0.0296423        0.265851             18.5      
    19        220         0.0296385       0.0664628             3.73      
    20        231         0.0296385       0.0664628             3.73      
    21        242         0.0296385       0.0166157             3.73      
    22        253         0.0296385      0.00415393             3.73      
    23        264         0.0296385      0.00103848             3.73      
    24        275         0.0296385      0.00025962             3.73      
    25        286         0.0296385     6.49051e-05             3.73      
    26        297         0.0296385     1.62263e-05             3.73      
    27        308         0.0296385     4.05657e-06             3.73      
    28        319         0.0296385     1.01414e-06             3.73      
    29        330         0.0296385     2.53535e-07             3.73      
    30        341         0.0296385     6.33839e-08             3.73      
    31        352         0.0296385      1.5846e-08            0.215      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6939.72                         1.12e+03
     1         22           5436.05              10              188      
     2         33           5230.64         9.71065              172      
     3         44            5193.7         19.0705              192      
     4         55           5120.31         38.1989              250      
     5         66           4833.28         75.6114              486      
     6         77           1697.18          167.09              568      
     7         88           589.951         50.9834              273      
     8         99           166.075         24.9037              110      
     9        110           39.3917         22.8429               64      
    10        121           6.84793         14.4072               11      
    11        132          0.986115         10.2077             36.8      
    12        143           0.24428         1.86819             17.7      
    13        154         0.0391855         2.00288             8.97      
    14        165         0.0297657        0.966926            0.812      
    15        176         0.0296739        0.206038            0.143      
    16        187         0.0296667        0.514881            0.116      
    17        198         0.0296664         0.12872          0.00212      
    18        209         0.0296664       0.0321801          0.00212      
    19        220         0.0296664      0.00804501          0.00212      
    20        231         0.0296664      0.00201125          0.00212      
    21        242         0.0296664     0.000502813            0.132      
    22        253         0.0296664     0.000125703            0.132      
    23        264         0.0296663     3.14258e-05           0.0797      
    24        275         0.0296663     7.85646e-06           0.0797      
    25        286         0.0296663     1.96411e-06           0.0797      
    26        297         0.0296663     4.91029e-07           0.0797      
    27        308         0.0296663     1.22757e-07           0.0797      
    28        319         0.0296663     3.06893e-08           0.0797      
    29        330         0.0296663     7.67232e-09           0.0797      

优化已停止，因为当前步长的范数 7.672323e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.20%, 最大相对误差 = 103.29%
Trust-Region-Reflective: 平均相对误差 = 4.20%, 最大相对误差 = 103.07%

Levenberg-Marquardt: 负区域误差 = 1.13%, 正区域误差 = 6.02%
Trust-Region-Reflective: 负区域误差 = 1.13%, 正区域误差 = 6.02%
整体表现更好: Trust-Region-Reflective算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0296298         0.00103         0.01
     1          22        0.0296297         0.00202        0.001     0.00415713
     2          36        0.0296295         0.00222            1    0.000552759
     3          48        0.0296294         0.00136           10    0.000213979
     4          59        0.0296294         0.00104            1    0.000122417
     5          72        0.0296294        0.000988          100    1.18378e-05
     6          73                                                 9.77068e-06

优化已停止，因为当前步长的相对范数 9.767812e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 103.26%
平均相对误差: 4.20%
平均误差 4.20% 低于阈值，结束优化。

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0530515           0.114         0.01
     1          22         0.030243         0.00661        0.001       0.247046
     2          33        0.0296733         0.00291       0.0001        0.32706
     3          44         0.029631         0.00173        1e-05       0.135148
     4          55        0.0296207         0.00255        1e-06       0.166708
     5          72        0.0296202        0.000433            1     0.00185987
     6          75                                                 5.98589e-06

优化已停止，因为当前步长的相对范数 7.259378e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          6255.67           0.136         0.01
     1          22          5078.33         6.4e-05        0.001        147.047
     2          33          5064.87         3.6e-07       0.0001        139.349
     3          44          5064.05        3.64e-07        1e-05        127.042
     4          55          5055.76        3.96e-07        1e-06         649.95
     5          66          4950.91        9.96e-07        1e-07        6500.13
     6          77          2494.89             167        1e-08        79849.7
     7          88          153.895             692        1e-09        281.396
     8          99          45.1644             129        1e-10        12.1075
     9         110          15.2376            20.9        1e-11        30.5833
    10         121           4.0164            2.44        1e-12        3.98265
    11         145          3.19192            1.58           10       0.218147
    12         156          2.76906             1.2            1       0.156611
    13         167          2.04096            3.63          0.1       0.786581
    14         178          1.04633           0.234         0.01        1.65702
    15         189         0.457537          0.0161        0.001        3.91594
    16         200         0.136332           0.109       0.0001        7.38014
    17         211        0.0373001          0.0597        1e-05        5.78959
    18         222        0.0342177         0.00232        1e-06       0.657143
    19         235        0.0333866          0.0263       0.0001        2.36929
    20         246        0.0326219         0.00566        1e-05       0.282475
    21         257        0.0325828         0.00317        1e-06      0.0831971
    22         268        0.0323416         0.00125        1e-07       0.543965
    23         289        0.0323416         0.00208         1000    1.29283e-06
    24         300        0.0323416         0.00143          100    2.43411e-06
    25         311        0.0323416         0.00226           10    1.64157e-05
    26         322        0.0323411        0.000669            1    0.000256179
    27         333        0.0323405        0.000904          0.1    0.000583737
    28         349        0.0323405         0.00109        10000    1.07142e-07

优化已停止，因为当前步长的相对范数 4.355607e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5661.72          0.0204         0.01
     1          22          5189.12        1.99e-05        0.001        147.826
     2          33          5185.77        8.72e-08       0.0001        132.028
     3          52          5185.77        8.72e-08        10000      0.0122237

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          7719.17           0.132         0.01
     1          22          5270.73        6.09e-06        0.001        21.5769
     2          33          5269.13        6.24e-06       0.0001        133.129
     3          44          5268.77        2.36e-08        1e-05        313.298
     4          55          5268.15        2.38e-08        1e-06        218.234
     5          66          5261.79        2.67e-08        1e-07        1765.76
     6          77          5164.52        1.87e-05        1e-08        18471.6
     7          88          400.775            4.37        1e-09         280775
     8         106          184.029            18.9         0.01         57.023
     9         117          83.2042            72.2        0.001        44.0663
    10         128          14.3308            18.8       0.0001        7.77081
    11         139          1.59338             2.8        1e-05        7.05931
    12         150        0.0919101           0.341        1e-06        4.23367
    13         161        0.0310457          0.0212        1e-07        1.65936
    14         172         0.029641         0.00751        1e-08        3.71988
    15         183        0.0296169         0.00128        1e-09        74.2723
    16         203        0.0296169         0.00167            1    0.000402159
    17         215        0.0296168        0.000549           10    0.000175357
    18         226        0.0296168         0.00108            1    6.06253e-05
    19         239        0.0296168         0.00176          100    1.42542e-05
    20         241                                                 2.11456e-06

优化已停止，因为当前步长的相对范数 2.113934e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          7594.97             0.3         0.01
     1          22          5133.56        3.68e-05        0.001        26.2228
     2          33          5125.79        1.86e-07       0.0001        133.983
     3          44          5125.36        1.87e-07        1e-05        125.186
     4          55          5120.93        1.97e-07        1e-06         488.54
     5          66          5069.27        3.45e-07        1e-07        4756.11
     6          77          2945.74             292        1e-08        56873.1
     7          88          1034.43            32.7        1e-09        32.9352
     8          99          311.058            11.4        1e-10        124.747
     9         110          74.3924            85.9        1e-11        203.135
    10         124          13.0873            16.6        1e-08        709.015
    11         135          1.39046            2.48        1e-09        74.0266
    12         146        0.0775168           0.272        1e-10        26.9774
    13         157        0.0298422         0.00148        1e-11        25.4332
    14         168        0.0297589         0.00146        1e-12        6.89176
    15         179        0.0297386         0.00197        1e-13        2.51174
    16         197         0.029736         0.00269        1e-06        3.54144
    17         208        0.0297177         0.00125        1e-07        11.8821
    18         219        0.0297155        0.000608        1e-08       0.689312
    19         237        0.0297154         0.00153          0.1     0.00455377
    20         252        0.0297154        0.000725         1000      1.594e-06
    21         253                                                 7.85775e-07

优化已停止，因为当前步长的相对范数 5.616394e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11         0.0296168                             4.08
     1         22         0.0296168         1.61109             4.08      
     2         33         0.0296162        0.402773              0.1      
     3         44         0.0296162        0.100693              0.1      
     4         55         0.0296162       0.0251733              0.1      
     5         66         0.0296162      0.00629332              0.1      
     6         77         0.0296162      0.00157333              0.1      
     7         88         0.0296162     0.000393333              0.1      
     8         99         0.0296162     9.83332e-05              0.1      
     9        110         0.0296162     2.45833e-05              0.1      
    10        121         0.0296162     6.14582e-06              0.1      
    11        132         0.0296162     1.53646e-06              0.1      
    12        143         0.0296162     3.84114e-07              0.1      
    13        154         0.0296162     9.60285e-08              0.1      
    14        165         0.0296162     2.40071e-08              0.1      
    15        176         0.0296162     6.00178e-09              0.1      

优化已停止，因为当前步长的范数 6.001781e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5134.26                              961
     1         22           4562.46              10              684      
     2         33            4322.3         19.4686              703      
     3         44           3894.54         36.3085              768      
     4         55           3496.64         28.4828              782      
     5         66           1328.39         92.5474              470      
     6         77           556.005         38.4907              255      
     7         88           154.872         25.0912              102      
     8         99           34.9046         11.7847             34.9      
     9        110           5.61189         6.67134             9.82      
    10        121           0.91608         4.40567             43.9      
    11        132          0.276484          3.5156             23.1      
    12        143          0.114088         5.90577             9.69      
    13        154         0.0331155         11.0153             38.6      
    14        165         0.0296867         1.23541           0.0601      
    15        176         0.0296431         3.66201               26      
    16        187         0.0296364        0.426181             1.04      
    17        198         0.0296364        0.106545             1.04      
    18        209         0.0296364       0.0266363             1.04      
    19        220         0.0296364      0.00665908             1.04      
    20        231         0.0296364      0.00166477             1.04      
    21        242         0.0296364     0.000416193             1.04      
    22        253         0.0296364     0.000104048             1.04      
    23        264         0.0296364      2.6012e-05             1.04      
    24        275         0.0296364     6.50301e-06             1.04      
    25        286         0.0296364     1.62575e-06             1.04      
    26        297         0.0296364     4.06438e-07             1.04      
    27        308         0.0296364      1.0161e-07             1.04      
    28        319         0.0296364     2.54024e-08             1.04      
    29        330         0.0296364     6.35059e-09             1.04      

优化已停止，因为当前步长的范数 6.350595e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           7724.88                         1.61e+03
     1         22            5703.9              10              273      
     2         33           5202.25              20              205      
     3         44           5100.78         38.3353              267      
     4         55            4770.5         77.2622              527      
     5         66           1728.64         160.495              576      
     6         77           582.428         47.1433              271      
     7         88           163.588         21.6801              109      
     8         99           38.2258         10.7126             36.9      
     9        110           6.54094         5.97548              196      
    10        121           1.06426         10.6855               65      
    11        132          0.284152         9.41312               25      
    12        143         0.0444665         7.91732              681      
    13        154         0.0297753         3.64258               25      
    14        165          0.029637         1.34231           0.0145      
    15        176          0.029637         1.02735           0.0145      
    16        187          0.029637        0.256837             4.43      
    17        198          0.029637       0.0642093             4.43      
    18        209          0.029637       0.0160523             4.43      
    19        220          0.029637      0.00401308             4.43      
    20        231          0.029637      0.00100327             4.43      
    21        242          0.029637     0.000250818             4.43      
    22        253          0.029637     6.27044e-05             4.43      
    23        264          0.029637     1.56761e-05             4.43      
284         end                
    24        275          0.029637     3.91902e-06             5.24      
    25        286          0.029637     9.79756e-07            0.169      
    26        297          0.029637     2.44939e-07            0.169      
    27        308          0.029637     6.12348e-08          0.00191      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5309.27                         1.28e+03
     1         22           4639.57              10         1.01e+03      
     2         33           4010.15              20              798      
     3         44           3389.97              40              777      
     4         55           1277.54         91.8087              455      
     5         66           409.788         42.3559              204      
     6         77           108.181         20.2194             78.3      
     7         88            23.607         20.3955             25.5      
     8         99           3.69741         14.8882             68.9      
     9        110          0.542524         5.64268             18.9      
    10        121          0.134814         1.33195             11.3      
    11        132         0.0375373         2.81214            0.801      
    12        143         0.0305428        0.310586            0.318      
    13        154         0.0303663        0.261843             26.9      
    14        165         0.0302357        0.154191             9.43      
    15        176         0.0302263        0.017123             4.59      
    16        187         0.0302207      0.00428076             5.41      
    17        198         0.0302183      0.00856152           0.0116      
    18        209         0.0302183      0.00856152           0.0116      
    19        220         0.0302178      0.00214038             1.47      
    20        231         0.0302178     0.000535095             6.59      
    21        242         0.0302178     0.000133774             6.59      
    22        253         0.0302178     3.34434e-05             6.59      
    23        264         0.0302178     8.36086e-06             6.59      
    24        275         0.0302178     2.09021e-06             6.59      
    25        286         0.0302178     5.22554e-07             6.59      
    26        297         0.0302178     1.30638e-07             6.59      
    27        308         0.0302178     3.26596e-08           0.0811      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           4349.36                         1.05e+03
     1         22           3828.76              10              858      
     2         33           3366.48              20              753      
     3         44           2695.22         37.8095              693      
     4         55           977.465         72.1511              362      
     5         66           299.979         30.4061              156      
     6         77           74.7374         15.2364             57.8      
     7         88           15.0809         19.9718               18      
     8         99           2.06061         7.16912              4.6      
     9        110          0.344541          6.6238             1.12      
    10        121         0.0755467         3.60389             4.02      
    11        132         0.0314242         9.22047             2.96      
    12        143           0.02963        0.478634              0.7      
    13        154           0.02963         7.82153              0.7      
    14        165         0.0296275         1.95538            0.115      
    15        176         0.0296275        0.488846            0.115      
    16        187         0.0296275        0.122211            0.115      
    17        198         0.0296274       0.0305528          0.00312      
    18        209         0.0296274      0.00763821          0.00312      
    19        220         0.0296264      0.00190955           0.0456      
    20        231         0.0296263     0.000477388             2.76      
    21        242         0.0296263     0.000477388             2.76      
    22        253         0.0296263     0.000119347             2.76      
    23        264         0.0296263     2.98368e-05             2.76      
    24        275         0.0296263     7.45919e-06             2.76      
    25        286         0.0296263      1.8648e-06             2.76      
    26        297         0.0296263     4.66199e-07             2.76      
    27        308         0.0296263      1.1655e-07             2.76      
    28        319         0.0296263     2.91375e-08             2.76      
    29        330         0.0296263     7.28437e-09             2.76      

优化已停止，因为当前步长的范数 7.284367e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.29%, 最大相对误差 = 102.87%
Trust-Region-Reflective: 平均相对误差 = 4.29%, 最大相对误差 = 102.94%

Levenberg-Marquardt: 负区域误差 = 1.30%, 正区域误差 = 5.98%
Trust-Region-Reflective: 负区域误差 = 1.30%, 正区域误差 = 5.98%
整体表现更好: Levenberg-Marquardt算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0296168         0.00217         0.01
     1          25        0.0296168         0.00194           10    0.000229424
     2          28                                                 1.99915e-06

优化已停止，因为当前步长的相对范数 1.998559e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 102.99%
平均相对误差: 4.29%
平均误差 4.29% 低于阈值，结束优化。

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0688421           0.149         0.01
     1          22        0.0314667          0.0175        0.001       0.367263
     2          33        0.0298172         0.00654       0.0001       0.354759
     3          44        0.0297657         0.00323        1e-05       0.103202
     4          55        0.0297565         0.00228        1e-06       0.112509
     5          70        0.0297533         0.00181         0.01     0.00943435
     6          81        0.0297506          0.0011        0.001     0.00926019
     7          94        0.0297493         0.00135          0.1     0.00449711
     8         106        0.0297492         0.00179            1     0.00106418
     9         118        0.0297492         0.00166           10    0.000176701
    10         129        0.0297491         0.00101            1    0.000173462
    11         140        0.0297489         0.00157          0.1    0.000431974
    12         154        0.0297489         0.00132          100    1.76144e-05
    13         156                                                 1.68174e-06

优化已停止，因为当前步长的相对范数 2.038896e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5787.83           0.024         0.01
     1          22          5227.67        1.17e-05        0.001        159.005
     2          33          5224.66         1.2e-05       0.0001        131.883
     3          44           5223.6        5.03e-08        1e-05        408.714
     4          55          5222.32        5.13e-08        1e-06        281.368
     5          66          5208.79        6.29e-08        1e-07        2540.62
     6          77          4880.15        1.66e-06        1e-08        27543.4
     7          88          3203.47             372        1e-09         257089
     8          99           1135.8            41.8        1e-10         108.89
     9         110          345.933            9.99        1e-11        1.08488
    10         121          84.8853            74.6        1e-12        363.763
    11         137           15.949            19.7        1e-07         94.993
    12         148          1.83316            2.95        1e-08        173.962
    13         159         0.107415           0.348        1e-09        79.7579
    14         170        0.0301608          0.0112        1e-10        5.03479
    15         181        0.0297878        0.000475        1e-11        22.4571
    16         192        0.0297728         0.00138        1e-12        23.0894
    17         203        0.0297652         0.00133        1e-13        6.36391
    18         214        0.0297608         0.00133        1e-14        36.9526
    19         240        0.0297608         0.00087           10    0.000133336
    20         251        0.0297608         0.00221            1    8.65917e-05
    21         255                                                 2.58843e-06

优化已停止，因为当前步长的相对范数 6.474217e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          778.117             3.7         0.01
     1          22          648.412            2.15        0.001        122.224
     2          33          431.635            5.01       0.0001        260.193
     3          45          249.262           0.181        0.001        252.677
     4          56             90.9          0.0293       0.0001        227.388
     5          68           7.2842            13.3        0.001        149.107
     6          79          1.99095            7.83       0.0001        25.6293
     7          90          1.33605            1.78        1e-05        4.19254
     8         101         0.341541            1.14        1e-06         8.2354
     9         112        0.0674407           0.319        1e-07        6.38592
    10         123        0.0304824          0.0374        1e-08        21.8499
    11         134        0.0297648        0.000875        1e-09        81.7806
    12         149        0.0297648         0.00162        1e-05       0.165855
    13         158                                                 1.96807e-06

优化已停止，因为当前步长的相对范数 4.499796e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          2598.09           0.544         0.01
     1          22          2410.13          0.0011        0.001        115.939
     2          33          2388.18         0.00114       0.0001         104.72
     3          44           2162.6         0.00175        1e-05        1009.86
     4          56           1883.6         0.00299       0.0001         1106.9
     5          67          1522.58         0.00617        1e-05        1227.81
     6          79          1022.58          0.0184       0.0001        1372.02
     7          90          275.043          0.0262        1e-05        1458.25
     8         103          121.094          0.0315        0.001        232.701
     9         114          19.8646            10.8       0.0001         170.04
    10         125          2.01429            2.58        1e-05        72.1072
    11         136         0.146944           0.124        1e-06        27.6485
    12         147        0.0309896          0.0139        1e-07        13.8213
    13         158        0.0297742          0.0021        1e-08        4.37107
    14         177        0.0297732         0.00119            1     0.00174108
    15         188        0.0297721         0.00185          0.1    0.000387376
    16         200        0.0297719         0.00109            1     0.00142418
    17         211        0.0297716         0.00217          0.1    0.000973188
    18         224        0.0297716        0.000727           10    0.000217709
    19         235        0.0297715        0.000806            1     7.2282e-05
    20         248        0.0297715         0.00166          100    8.08244e-06
    21         259        0.0297715          0.0021           10    1.65822e-05
    22         270        0.0297715         0.00141            1    0.000216129
    23         282        0.0297715         0.00184           10     0.00014141
    24         294        0.0297715         0.00115          100    1.78884e-05
    25         296                                                 1.41051e-06

优化已停止，因为当前步长的相对范数 4.633001e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          8935.95            0.21         0.01
     1          22          5265.34        6.68e-06        0.001        19.5429
     2          33          5263.59        6.86e-06       0.0001        132.904
     3          44          5260.65        2.73e-08        1e-05        325.065
     4          55          5259.94        2.76e-08        1e-06         228.08
     5          66          5252.58        3.14e-08        1e-07        1893.06
     6          77          5133.29         1.7e-07        1e-08        20079.6
     7          88          3203.47             376        1e-09         314008
     8          99          1134.51            40.8        1e-10        129.787
     9         110          344.018              10        1e-11        228.544
    10         121          82.2468            77.2        1e-12        660.975
    11         132          15.0453            18.7        1e-13        37.4393
    12         143           1.6887            2.79        1e-14        82.5115
    13         154         0.096163           0.317        1e-15        21.9953
    14         165        0.0300556         0.00976        1e-16        34.9957
    15         176        0.0297891         0.00197        1e-17        4.40232
    16         187        0.0297846        0.000508        1e-18        35.0193
    17         209        0.0297833         0.00339        1e-07        23.1145
    18         220        0.0297814         0.00179        1e-08        28.3316
    19         231        0.0297748         0.00188        1e-09        55.3008
    20         244        0.0297682         0.00143        1e-07        24.9227
    21         261        0.0297674        0.000634          0.1     0.00554686
    22         272        0.0297659        0.000429         0.01     0.00404031
    23         285        0.0297659         0.00134            1    0.000339217
    24         299        0.0297659        0.000783         1000    1.35185e-06

优化已停止，因为当前步长的相对范数 4.060336e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11         0.0297489                             3.97
     1         22         0.0297489          4.3758             3.97      
     2         33         0.0297484         1.09395             6.81      
     3         44         0.0297484        0.273487             6.81      
     4         55         0.0297484       0.0683718             6.81      
     5         66         0.0297484        0.017093             6.81      
     6         77         0.0297484      0.00427324             6.81      
     7         88         0.0297484      0.00106831             6.81      
     8         99         0.0297484     0.000267077             6.81      
     9        110         0.0297484     6.67694e-05             6.81      
    10        121         0.0297484     1.66923e-05             6.81      
    11        132         0.0297484     4.17308e-06             6.81      
    12        143         0.0297484     1.04327e-06           0.0951      
    13        154         0.0297484     2.60818e-07           0.0951      
    14        165         0.0297484     6.52045e-08           0.0951      
    15        176         0.0297484     1.63011e-08           0.0951      
    16        187         0.0297484     4.07528e-09           0.0951      

优化已停止，因为当前步长的范数 4.075278e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11            5127.8                              307
     1         22           5043.39          9.5949              314      
     2         33           4974.66         19.0403              369      
     3         44           4775.37              40              518      
     4         55           3981.81              80              768      
     5         66           1540.84         111.293              526      
     6         77           510.605         47.8574              243      
     7         88            140.14         21.6309               96      
     8         99            31.477         11.4337             32.3      
     9        110            5.1097         6.56634             50.3      
    10        121          0.768646         4.28156               22      
    11        132          0.248701         21.4142             15.5      
    12        143         0.0362641         2.11663             17.8      
    13        154         0.0298339          7.4768            0.588      
    14        165         0.0297884       0.0593392            0.176      
    15        176         0.0297731         7.82309            0.221      
    16        187         0.0297731        0.348511            0.221      
    17        198         0.0297716       0.0871277            0.122      
    18        209         0.0297716       0.0217819            0.122      
    19        220         0.0297716      0.00544548            0.122      
    20        231         0.0297716      0.00136137            0.122      
    21        242         0.0297716     0.000340342            0.122      
    22        253         0.0297715     8.50856e-05          0.00316      
    23        264         0.0297715     2.12714e-05          0.00121      
    24        275         0.0297715     5.31785e-06            0.102      
    25        286         0.0297715     5.31785e-06            0.102      
    26        297         0.0297714     1.32946e-06          0.00142      
    27        308         0.0297714     3.32366e-07          0.00142      
    28        319         0.0297714     8.30914e-08          0.00142      
    29        330         0.0297714     2.07729e-08          0.00142      
    30        341         0.0297714     5.19321e-09          0.00142      

优化已停止，因为当前步长的范数 5.193214e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5735.75                              256
     1         22           5285.08         9.95717              140      
     2         33           5244.21         19.0788              153      
     3         44           5189.26         38.1392              193      
     4         55           4995.37         74.7921              355      
     5         66           1763.91         185.968              580      
     6         77           596.382         47.7561              274      
     7         88           168.128         21.8967              111      
     8         99           39.1208         10.8215             37.8      
     9        110           6.67404         5.99457              162      
    10        121           1.03834         8.80656             51.4      
    11        132          0.271118         7.68576             24.7      
    12        143         0.0415822         3.88426              9.9      
    13        154         0.0300295         4.23301            0.336      
    14        165         0.0297602        0.289495            0.245      
    15        176         0.0297577          5.2716          0.00234      
    16        187         0.0297577          1.3179          0.00234      
    17        198         0.0297577        0.329475          0.00234      
    18        209         0.0297577       0.0823688          0.00234      
    19        220         0.0297577       0.0205922          0.00234      
    20        231         0.0297577      0.00514805          0.00234      
    21        242         0.0297565      0.00128701             8.11      
    22        253         0.0297564     0.000321753            0.091      
    23        264         0.0297564     8.04383e-05            0.091      
    24        275         0.0297564     2.01096e-05            0.091      
    25        286         0.0297564     5.02739e-06            0.091      
    26        297         0.0297564     1.25685e-06            0.091      
    27        308         0.0297564     3.14212e-07            0.091      
    28        319         0.0297564      7.8553e-08            0.091      
    29        330         0.0297564     1.96382e-08            0.091      
    30        341         0.0297564     4.90956e-09            0.091      

优化已停止，因为当前步长的范数 4.909562e-09 
小于 options.StepTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6916.42                         1.35e+03
     1         22           5516.13              10              582      
     2         33            4953.8              20              425      
     3         44           4707.59         38.7286              562      
     4         55           3876.06         77.8709              780      
     5         66           1494.75          106.69              515      
     6         77           534.606         45.7582              251      
     7         88           147.855         23.3087             99.8      
     8         99           33.6771          11.858             33.7      
     9        110           5.70231         17.2262              103      
    10        121           0.92253         6.63607             43.5      
    11        132          0.220452         4.88307             17.7      
    12        143         0.0925933         1.36759             8.62      
    13        154         0.0364002         12.2115             1.59      
    14        165         0.0299988         1.03893             47.4      
    15        176          0.029769         2.07842             15.8      
    16        187         0.0297662         4.26036             3.31      
    17        198         0.0297662         1.06509             3.31      
    18        209         0.0297647        0.266272             1.01      
    19        220          0.029764       0.0665681            0.144      
    20        231          0.029764        0.016642            0.144      
    21        242          0.029764       0.0041605            0.144      
    22        253          0.029764      0.00104013            0.144      
    23        264          0.029764     0.000260032            0.144      
    24        275          0.029764     6.50079e-05            0.144      
    25        286          0.029764      1.6252e-05            0.144      
    26        297          0.029764     4.06299e-06            0.144      
    27        308          0.029764     1.01575e-06            0.144      
    28        319          0.029764     2.53937e-07            0.144      
    29        330          0.029764     6.34843e-08          0.00166      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           5919.81                            1e+03
     1         22           5001.68              10              532      
     2         33           4759.36         19.5314              537      
     3         44           4457.32          38.662              670      
     4         55           3584.58         69.2704              790      
     5         66           1972.12              80              619      
     6         77           678.648         57.8255              298      
     7         88           195.543         31.0597              122      
     8         99           57.6781         44.0455             50.1      
     9        110            11.198         16.4411             72.6      
    10        121           1.75191         8.35814             49.8      
    11        132          0.333916         4.22463             29.7      
    12        143         0.0634017         19.8577             8.46      
    13        154          0.045223         1.34128              520      
    14        165         0.0303042          7.7276             32.7      
    15        176         0.0297851        0.475739           0.0982      
    16        187         0.0297779        0.785953             1.32      
    17        198         0.0297767        0.196488             9.29      
    18        209         0.0297767        0.049122             9.29      
    19        220         0.0297767       0.0122805             9.29      
    20        231         0.0297767      0.00307013             9.29      
    21        242         0.0297767     0.000767532             9.29      
    22        253         0.0297767     0.000191883             9.29      
    23        264         0.0297767     4.79707e-05             9.29      
    24        275         0.0297767     1.19927e-05             9.29      
    25        286         0.0297767     2.99817e-06             9.29      
    26        297         0.0297767     7.49543e-07             9.29      
    27        308         0.0297767     1.87386e-07             9.29      
    28        319         0.0297767     4.68464e-08             9.29      
    29        330         0.0297767     1.17116e-08             9.29      
    30        341         0.0297767      2.9279e-09             9.29      

优化已停止，因为当前步长的范数 2.927902e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.39%, 最大相对误差 = 102.86%
Trust-Region-Reflective: 平均相对误差 = 4.39%, 最大相对误差 = 103.25%

Levenberg-Marquardt: 负区域误差 = 1.49%, 正区域误差 = 5.93%
Trust-Region-Reflective: 负区域误差 = 1.50%, 正区域误差 = 5.92%
整体表现更好: Levenberg-Marquardt算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0297489         0.00138         0.01
     1          17                                                 1.41387e-06

优化已停止，因为当前步长的相对范数 1.714135e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 102.76%
平均相对误差: 4.39%
平均误差 4.39% 低于阈值，结束优化。

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11         0.087373           0.183         0.01
     1          22        0.0318961          0.0125        0.001       0.421923
     2          33        0.0301659         0.00203       0.0001       0.456649
     3          44        0.0300262         0.00171        1e-05       0.185473
     4          55         0.030008        0.000646        1e-06       0.074552
     5          64                                                 6.45167e-06

优化已停止，因为当前步长的相对范数 7.823225e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          7536.94           0.243         0.01
     1          22          5168.41        2.35e-05        0.001        17.4476
     2          33          5168.06        1.11e-07       0.0001        131.689
     3          44          5167.79        1.11e-07        1e-05        126.037
     4          55          5165.09        1.94e-06        1e-06        389.573
     5          66          5135.12        1.67e-07        1e-07         3916.8
     6          77          3219.03        0.000238        1e-08        42818.5
     7          88          2754.81             233        1e-09        43462.2
     8          99          92.3053            10.9        1e-10        288.241
     9         122          59.2079             168          100       0.276603
    10         133          17.5573            35.5           10       0.255887
    11         144          4.54296            7.17            1       0.414673
    12         155          1.20712            1.55          0.1       0.609391
    13         166         0.487616           0.495         0.01       0.711892
    14         177         0.351407          0.0143        0.001        1.18997
    15         188         0.300429          0.0332       0.0001        1.98546
    16         199         0.282082          0.0219        1e-05       0.473096
    17         210          0.16488           0.132        1e-06         6.7872
    18         221        0.0844318           0.185        1e-07        6.64281
    19         232        0.0528209          0.0268        1e-08        2.72175
    20         243        0.0509899          0.0272        1e-09       0.415516
    21         254        0.0442786         0.00532        1e-10       0.642431
    22         265        0.0430426          0.0074        1e-11       0.341855
    23         284        0.0396932          0.0389        0.001        1.42627
    24         295        0.0363237         0.00266       0.0001       0.510067
    25         306        0.0349938         0.00135        1e-05       0.861329
    26         317         0.033588         0.00607        1e-06         1.4688
    27         328        0.0326415         0.00502        1e-07        1.22826
    28         339        0.0320975         0.00414        1e-08       0.810067
    29         353        0.0318925          0.0197        1e-05        3.31458
    30         364        0.0312381          0.0165        1e-06        5.32099
    31         375        0.0306963         0.00266        1e-07       0.240574
    32         386        0.0306371         0.00502        1e-08       0.526724
    33         397        0.0305019         0.00213        1e-09        3.94564
    34         408        0.0304699          0.0036        1e-10       0.752304
    35         419        0.0304512          0.0012        1e-11       0.425016
    36         444        0.0304512         0.00147         1000    1.55148e-06

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          3620.76            1.24         0.01
     1          22          3175.92         0.00159        0.001        81.3857
     2          33          3161.17        0.000266       0.0001         186.98
     3          44          3057.66        0.000324        1e-05        703.746
     4          55          1757.61         0.00383        1e-06        6318.74
     5          68          1352.64         0.00885       0.0001        1281.01
     6          79          773.105          0.0205        1e-05        1424.62
     7          91          26.1022              45       0.0001        1369.61
     8         102          7.29122              25        1e-05         11.243
     9         113          2.02427            3.33        1e-06        6.31588
    10         124         0.460646           0.437        1e-07        22.4369
    11         135        0.0425857          0.0757        1e-08        6.12749
    12         146        0.0302121         0.00441        1e-09         20.339
    13         157        0.0300777         0.00215        1e-10        3.87204
    14         173        0.0300774         0.00178        1e-05        2.56468
    15         184        0.0300724        0.000502        1e-06        1.39521
    16         196        0.0300714         0.00143        1e-05         1.5847
    17         206                                                 1.57718e-07

优化已停止，因为当前步长的相对范数 1.850496e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5693.99          0.0149         0.01
     1          22          5258.47        7.43e-06        0.001        155.439
     2          33          5257.49        2.88e-08       0.0001        132.684
     3          44          5257.41        2.89e-08        1e-05        130.479
     4          55          5256.67        2.92e-08        1e-06        232.161
     5          66          5248.88        3.34e-08        1e-07         1945.1
     6          77          5119.22        2.01e-07        1e-08        20762.4
     7          88          3163.62             360        1e-09         321143
     8          99          892.513            21.9        1e-10          676.6
     9         110          262.351              14        1e-11        6.36795
    10         121          59.7038            94.7        1e-12        24.5357
    11         140          10.1208            13.7       0.0001        11.3962
    12         151         0.983618            2.01        1e-05        7.28088
    13         162        0.0566641           0.198        1e-06        8.75597
    14         173        0.0303116         0.00324        1e-07        2.38553
    15         185        0.0301794         0.00408        1e-06        7.95676
    16         196        0.0301627         0.00397        1e-07       0.833203
    17         212        0.0301607         0.00357         0.01      0.0217604
    18         225        0.0301582         0.00237            1     0.00204408
    19         236        0.0301581         0.00222          0.1    0.000713308
    20         250        0.0301581         0.00158          100    2.26487e-05
    21         253                                                 1.86841e-07

优化已停止，因为当前步长的相对范数 3.654276e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11           7464.1          0.0975         0.01
     1          22          5302.54        3.44e-06        0.001        22.8201
     2          33          5301.62         3.5e-06       0.0001        134.616
     3          44           5298.3        1.33e-08        1e-05        253.506
     4          55          5297.95        1.34e-08        1e-06        187.647
     5          66          5294.34        1.44e-08        1e-07        1337.59
     6          77          5247.64        5.27e-08        1e-08        13751.5
     7          88          393.595            3.17        1e-09         194181
     8         106          175.293            17.7         0.01        52.5648
     9         117           28.424            76.6        0.001        41.9755
    10         128           3.7828            9.74       0.0001        10.8743
    11         139         0.330748            1.42        1e-05        7.96385
    12         150        0.0421447           0.204        1e-06        1.69411
    13         161        0.0301289          0.0125        1e-07        1.61134
    14         172        0.0300128         0.00113        1e-08        1.16565
    15         183        0.0300089         0.00244        1e-09        14.0587
    16         196        0.0300087        0.000424        1e-07        1.06253
    17         207        0.0300074         0.00172        1e-08        22.1469
    18         218        0.0300046        0.000754        1e-09        100.923
    19         237        0.0300039        0.000233          0.1      0.0034598
    20         248        0.0300036         0.00226         0.01     0.00131659
    21         262        0.0300036        0.000494           10    0.000178855
    22         273        0.0300036         0.00136            1    4.88719e-05
    23         286        0.0300036        0.000596          100    1.38062e-05
    24         287                                                 7.12412e-06

优化已停止，因为当前步长的相对范数 8.683194e-09 
小于 options.StepTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

第四阶段：使用trust-region-reflective算法进行拟合...

                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11         0.0300036                          0.00146
     1         22         0.0300036        0.857744          0.00146      
     2         33         0.0300036        0.214436          0.00146      
     3         44         0.0300036        0.053609          0.00146      
     4         55         0.0300036       0.0134023          0.00146      
     5         66         0.0300036      0.00335056          0.00146      
     6         77         0.0300036     0.000837641          0.00146      
     7         88         0.0300036      0.00020941          0.00146      
     8         99         0.0300036     5.23525e-05           0.0145      
     9        110         0.0300036     1.30881e-05           0.0145      
    10        121         0.0300036     3.27203e-06           0.0145      
    11        132         0.0300036     8.18009e-07           0.0145      
    12        143         0.0300036     2.04502e-07           0.0145      
    13        154         0.0300036     5.11255e-08           0.0555      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           4952.96                         1.07e+03
     1         22           4341.04              10              781      
     2         33           4013.98          19.829              748      
     3         44           3518.42         35.9737              770      
     4         55           2840.22              40              734      
     5         66           1039.12          73.497              393      
     6         77           53.3226          41.105             47.1      
     7         88           9.24258         11.2815               14      
     8         99           1.43537         14.6222             57.6      
     9        110           0.30615         11.2843             34.8      
    10        121         0.0507322         6.75263             13.2      
    11        132          0.030923         3.82398             1.06      
    12        143         0.0300314         2.43519              5.7      
    13        154         0.0300227        0.165703             5.55      
    14        165         0.0300227        0.476368             5.55      
    15        176         0.0300218        0.119092           0.0547      
    16        187         0.0300218        0.029773           0.0547      
    17        198         0.0300218      0.00744325           0.0547      
    18        209         0.0300218      0.00186081           0.0547      
    19        220         0.0300218     0.000465203           0.0547      
    20        231         0.0300218     0.000116301           0.0547      
    21        242         0.0300218     2.90752e-05           0.0547      
    22        253         0.0300218      7.2688e-06           0.0547      
    23        264         0.0300218      1.8172e-06           0.0547      
    24        275         0.0300218       4.543e-07           0.0547      
    25        286         0.0300218     1.13575e-07          0.00129      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           7122.72                         1.26e+03
     1         22           5485.23              10              177      
     2         33           5248.07          9.7417              159      
     3         44           5212.09         19.0673              176      
     4         55           5145.26          38.112              228      
     5         66           4913.91         71.2738              422      
     6         77           4287.09              80              724      
     7         88           1001.04         137.705              396      
     8         99           308.126         31.3984              171      
     9        110           77.9927         25.8552             63.4      
    10        121           14.8484         15.8092             19.4      
    11        132           3.63773         9.77803         2.72e+04      
    12        143          0.534046         2.44451          4.6e+03      
    13        154          0.106759         4.88902              268      
    14        165          0.034495         3.93418              124      
    15        176         0.0300459         1.66746            0.376      
    16        187         0.0300211         4.75227            0.105      
    17        198         0.0300165         1.18807           0.0895      
    18        209          0.030016        0.297017           0.0973      
    19        220          0.030016       0.0742542           0.0973      
    20        231          0.030016       0.0185636           0.0973      
    21        242          0.030016      0.00464089           0.0973      
    22        253          0.030016      0.00116022           0.0973      
    23        264          0.030016     0.000290056           0.0973      
    24        275          0.030016     7.25139e-05           0.0973      
    25        286          0.030016     1.81285e-05           0.0973      
    26        297          0.030016     4.53212e-06           0.0973      
    27        308          0.030016     1.13303e-06           0.0973      
    28        319          0.030016     2.83257e-07           0.0973      
    29        330          0.030016     7.08144e-08           0.0548      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           6638.34                              877
     1         22           5431.84              10              121      
     2         33           5303.97         9.62801              117      
     3         44           5281.99         19.0422              127      
     4         55           5241.52         38.1241              156      
     5         66           5104.27         76.2998              264      
     6         77           3641.21             160              805      
     7         88           1388.79         100.532              500      
     8         99           451.572         41.4771              227      
     9        110           124.583         27.2321             89.5      
    10        121           29.3583         13.8785              380      
    11        132           5.04983         6.82324             8.12      
    12        143          0.697839         21.3534               12      
    13        154          0.178215         2.72716                9      
    14        165         0.0375446         6.41219             1.93      
    15        176         0.0300716        0.494598             26.1      
    16        187         0.0300124         1.19874          0.00351      
    17        198         0.0300124        0.303538          0.00351      
    18        209         0.0300124       0.0758846          0.00351      
    19        220         0.0300124       0.0189711          0.00351      
    20        231         0.0300124      0.00474279          0.00351      
    21        242         0.0300118       0.0011857            0.154      
    22        253         0.0300116     0.000296424            0.168      
    23        264         0.0300116      7.4106e-05            0.168      
    24        275         0.0300116     1.85265e-05            0.168      
    25        286         0.0300116     4.63163e-06            0.168      
    26        297         0.0300116     1.15791e-06            0.061      
    27        308         0.0300116     2.89477e-07            0.061      
    28        319         0.0300116     7.23692e-08             2.58      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


                                            Norm of      First-order 
 Iteration  Func-count      Resnorm            step       optimality
     0         11           4713.92                            1e+03
     1         22           4200.79              10              771      
     2         33           3913.84         19.6212              762      
     3         44           3433.41         34.5331              773      
     4         55           2753.05              40              728      
     5         66           1000.83         71.9802              384      
     6         77           308.029         39.8926              166      
     7         88           77.5644         23.6194             61.7      
     8         99           14.5612         12.1704             18.9      
     9        110           2.37547         16.7643              122      
    10        121          0.449235         3.06826             67.3      
    11        132         0.0934004         6.31933             19.6      
    12        143         0.0321147         5.28155             3.71      
    13        154         0.0300561         2.69249            0.426      
    14        165         0.0300455        0.040466           0.0123      
    15        176         0.0300455        0.253315           0.0123      
    16        187         0.0300455       0.0633289           0.0123      
    17        198         0.0300455       0.0158322           0.0123      
    18        209         0.0300455      0.00395805           0.0123      
    19        220         0.0300455     0.000989514           0.0123      
    20        231         0.0300455     0.000247378           0.0123      
    21        242         0.0300455     6.18446e-05           0.0123      
    22        253         0.0300455     1.54611e-05           0.0123      
    23        264         0.0300455     3.86529e-06           0.0123      
    24        275         0.0300455     9.66322e-07           0.0123      
    25        286         0.0300455      2.4158e-07           0.0123      
    26        297         0.0300455     6.03951e-08           0.0123      
    27        308         0.0300455     1.50988e-08           0.0427      

优化已停止，因为相对平方和 (r) 的变化小于 options.FunctionTolerance = 1.000000e-08。


MultiStart completed the runs from all start points. 

All 5 local solver runs converged with a positive local solver exitflag.

比较两种算法的结果：
Levenberg-Marquardt: 平均相对误差 = 4.49%, 最大相对误差 = 103.30%
Trust-Region-Reflective: 平均相对误差 = 4.49%, 最大相对误差 = 103.29%

Levenberg-Marquardt: 负区域误差 = 1.69%, 正区域误差 = 5.87%
Trust-Region-Reflective: 负区域误差 = 1.69%, 正区域误差 = 5.87%
整体表现更好: Trust-Region-Reflective算法

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11        0.0300036        0.000934         0.01
     1          24        0.0300035         0.00188            1    0.000786585
     2          37        0.0300035         0.00211          100    1.89102e-05
     3          39                                                 2.10469e-06

优化已停止，因为当前步长的相对范数 2.565296e-09 
小于 options.StepTolerance = 1.000000e-08。


每个点的相对误差统计：
最大相对误差: 102.91%
平均相对误差: 4.49%
平均误差 4.49% 低于阈值，结束优化。

第三阶段：全区域拟合...

                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11            0.108           0.217         0.01
     1          22        0.0333073          0.0184        0.001       0.520959
     2          33        0.0305521         0.00245       0.0001       0.520129
     3          44         0.030408         0.00156        1e-05       0.206771
     4          55         0.030376         0.00165        1e-06       0.157239
     5          66        0.0303754        0.000688        1e-07       0.162443
     6          77        0.0303738        0.000639        1e-08        22.9144
     7          96        0.0303737         0.00166            1    0.000531486
     8         108        0.0303737         0.00162           10    0.000165951
     9         121        0.0303736         0.00104         1000    1.67183e-06

优化已停止，因为当前步长的相对范数 2.084934e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5319.21        0.000134         0.01
     1          22          5283.57         4.9e-06        0.001        132.292
     2          33          5282.27           5e-06       0.0001        133.663
     3          44          5278.77        1.95e-08        1e-05        288.061
     4          55          5278.26        1.97e-08        1e-06        206.793
     5          66          5272.97        2.18e-08        1e-07        1612.41
     6          77          5197.15        7.44e-08        1e-08        16775.3
     7          88          396.916            2.68        1e-09         255114
     8          99          238.118              12        1e-10        1014.22
     9         110          54.1986            90.2        1e-11        590.796
    10         121          8.94428            16.2        1e-12         93.309
    11         132         0.872768            2.41        1e-13        15.2764
    12         143        0.0576409           0.292        1e-14        211.343
    13         154        0.0305158          0.0132        1e-15        162.181
    14         165        0.0303795          0.0022        1e-16         130.93
    15         186        0.0303768         0.00134        1e-06         3.0222
    16         197        0.0303753         0.00106        1e-07         1.8474
    17         215        0.0303751         0.00139            1    0.000903826
    18         229        0.0303751         0.00138         1000    1.94089e-06

优化已停止，因为当前步长的相对范数 3.588745e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          7378.31           0.288         0.01
     1          22          5122.84        4.14e-05        0.001        25.2567
     2          33          5115.68        2.09e-07       0.0001         134.84
     3          44           5115.2        2.11e-07        1e-05        125.193
     4          55          5110.27        2.23e-07        1e-06        506.205
     5          66          5051.89        4.11e-07        1e-07        5076.01
     6          77          197.439             145        1e-08        60652.4
     7          88          50.9144            73.1        1e-09        29.2794
     8          99          19.5744            22.4        1e-10        32.9974
     9         110          10.7048            2.07        1e-11        11.5019
    10         121          5.77211            16.3        1e-12        5.92031
    11         132          3.97137           0.153        1e-13        21.6184
    12         150          3.95608            31.8        1e-06         268.26
    13         161          2.76614            5.25        1e-07        33.6984
    14         172          1.28316            4.77        1e-08        128.859
    15         183         0.630737           0.954        1e-09        287.331
    16         195          0.11985           0.412        1e-08        415.443
    17         206        0.0352585          0.0896        1e-09        28.7092
    18         217        0.0304808          0.0118        1e-10        6.66232
    19         228         0.030417          0.0013        1e-11        1.48039
    20         245        0.0304058          0.0011        1e-05        1.17531
    21         261        0.0304055         0.00182            1    0.000987045
    22         272         0.030405        0.000966          0.1    0.000741708
    23         286         0.030405        0.000623          100    9.67019e-06
    24         297         0.030405        0.000897           10    6.30895e-06
    25         308         0.030405           0.001            1    8.85743e-05
    26         321         0.030405        0.000519          100     1.1931e-05
    27         323                                                 5.50884e-07

优化已停止，因为当前步长的相对范数 9.978760e-09 
小于 options.StepTolerance = 1.000000e-08。


                                        First-order                     Norm of 
 Iteration  Func-count      Resnorm      optimality       Lambda           step
     0          11          5210.86           0.197         0.01
     1          22          4623.57         0.00093        0.001        84.5412
     2          33           4611.3         6.8e-06       0.0001        260.123
     3          44          4601.68         0.00016        1e-05        247.906
     4          55           4503.1        1.02e-05        1e-06        2189.58
     5          66          2254.66         0.00272        1e-07        22688.3
     6          77          414.315            1.06        1e-08        19140.9
     7          88          189.644             702        1e-09        1060.04
     8          99          52.2088             188        1e-10          66.23
     9         110          20.1091            27.6        1e-11         28.385
    10         121          3.23021            2.89        1e-12        15.4237
    11         144          2.75355            9.21            1       0.834971
    12         155         0.937074            1.27          0.1       0.462878
    13         166         0.405474           0.053         0.01        1.20503
    14         177         0.197404          0.0866        0.001        2.22587
    15         188        0.0749538          0.0286       0.0001        5.13526
    16         199        0.0449061          0.0864        1e-05        2.60311
    17         210        0.0325967         0.00467        1e-06         1.6847
    18         221         0.032023          0.0099        1e-07        1.65484
    19         232        0.0318215         0.00202        1e-08       0.158862
K>> 
